var flgDetailFrameAllowed;
if(typeof(JMSLogger)=="undefined"){JMSLogger=function(flgOwnConsole,webLoggerUrl){this.console={};if(window.console){this.console=window.console;if(!window.console.debug&&typeof window.console.log!=="undefined"){window.console.debug=window.console.log;}}var names=["log","debug","info","warn","error","assert","dir","dirxml","group","groupEnd","time","timeEnd","count","trace","profile","profileEnd"];for(var i=0;i<names.length;++i){if(!this.console[names[i]]){this.console[names[i]]=function(){};}}this.ownConsoleElement=null;if(flgOwnConsole){this.ownConsoleElement=this.initOwnConsole();}this.webLoggerUrl=webLoggerUrl;};JMSLogger.prototype=Object();JMSLogger.prototype.logError=function(text){this.console.error(" ERROR:"+text);if(this.ownConsoleElement){this.logOwnConsole(text);}if(this.webLoggerUrl&&this.isErrorWebLogger){this.logWebLogger("ERROR",text);}};JMSLogger.prototype.logWarning=function(text){this.console.warn(" WARNING:"+text);if(this.ownConsoleElement){this.logOwnConsole(text);}if(this.webLoggerUrl&&this.isWarningWebLogger){this.logWebLogger("WARNING",text);}};JMSLogger.prototype.logInfo=function(text){this.console.info(" INFO:"+text);if(this.ownConsoleElement){this.logOwnConsole(text);}if(this.webLoggerUrl&&this.isInfoWebLogger){this.logWebLogger("INFO",text);}};JMSLogger.prototype.logDebug=function(text){this.console.debug(" DEBUG:"+text);if(this.ownConsoleElement){this.logOwnConsole(text);}if(this.webLoggerUrl&&this.isDebugWebLogger){this.logWebLogger("DEBUG",text);}};JMSLogger.prototype.initOwnConsole=function(){var consoleWindowElement=null;try{var consoleWindow=window.open("","JMSLoggerOwnConsole","height=400,width=650,resizable=yes,scrollbars=yes");consoleWindowElement=consoleWindow.document.getElementById("JMSLoggerOwnConsoleDiv");if(!consoleWindowElement){consoleWindow.document.write("<textarea id='JMSLoggerOwnConsoleDiv' cols='80' rows='40'></textarea>");consoleWindowElement=consoleWindow.document.getElementById("JMSLoggerOwnConsoleDiv");}}catch(e){this.logError("JMSLOGGER.initOwnConsole cant open Console window: "+e);}return consoleWindowElement;};JMSLogger.prototype.logOwnConsole=function(text){if(this.ownConsoleElement){try{this.ownConsoleElement.value=this.ownConsoleElement.value+"\n"+text;}catch(e){}}};JMSLogger.prototype.logWebLogger=function(logLevel,text){if(this.webLoggerUrl){try{var url=this.webLoggerUrl+"LOGLEVEL="+logLevel+"&LOGMSG="+text+"&LOGURL="+window.location;logElement=document.createElement("script");logElement.src=url;parent=document.getElementsByTagName("script")[0];parent.parentNode.insertBefore(logElement,parent);}catch(e){}}};JMSLogger.prototype.isError=true;JMSLogger.prototype.isErrorWebLogger=false;JMSLogger.prototype.isWarning=false;JMSLogger.prototype.isWarningWebLogger=false;JMSLogger.prototype.isInfo=false;JMSLogger.prototype.isInfoWebLogger=false;JMSLogger.prototype.isDebug=false;JMSLogger.prototype.isDebugWebLogger=false;JMSLogger.prototype.jmsLoggerRoot=false;}if(typeof(JMSClass)=="undefined"){JMSClass=function(){this.FLG_CHECK_CLASSES=0;if(this.FLG_CHECK_CLASSES){this.mpClassHirarchie=[];this.lstClassHirarchie=[];this.setClassName("JMSClass");}};JMSClass.prototype=Object();JMSClass.prototype.doAlert=function(text){var msg=" ALERT:"+text+" for "+this.getClassHirarchie()+" "+this;alert(msg);if(this.jmsLoggerJMSClass){this.jmsLoggerJMSClass.logError(msg);}};JMSClass.prototype.logError=function(text){var msg=" ERROR:"+text+" for "+this.getClassHirarchie()+" "+this;alert(msg);if(this.jmsLoggerJMSClass){this.jmsLoggerJMSClass.logError(msg);}};JMSClass.prototype.setClassName=function(className){if(!this.FLG_CHECK_CLASSES){return null;}this.lstClassHirarchie.push(className);this.mpClassHirarchie[className]=className;};JMSClass.prototype.getClassName=function(){if(!this.FLG_CHECK_CLASSES){return"FLG_CHECK_CLASSES not set";}return this.lstClassHirarchie[this.lstClassHirarchie.length];};JMSClass.prototype.getClassHirarchie=function(){if(!this.FLG_CHECK_CLASSES){return"FLG_CHECK_CLASSES not set";}var classHirarchie="";for(var i in this.lstClassHirarchie){classHirarchie=this.lstClassHirarchie[i]+" -- "+classHirarchie;}return classHirarchie;};JMSClass.prototype.isInstanceOf=function(className){if(!this.FLG_CHECK_CLASSES){return true;}if(this.mpClassHirarchie[className]){return true;}else{return false;}};JMSClass.prototype.checkInstanceOf=function(obj,className){if(!this.FLG_CHECK_CLASSES){return true;}var flg=false;try{eval("if (obj.isInstanceOf(className)) { flg = true; }");}catch(e){alert("Exception:"+e);}return flg;};JMSClass.prototype.isEmpty=function(obj){for(var i in obj){return false;}return true;};JMSClass.prototype.jmsLoggerJMSClass=false;}else{if(JMSClass.prototype.jmsLoggerJMSClass&&JMSClass.prototype.jmsLoggerJMSClass.isDebug){JMSClass.prototype.jmsLoggerJMSClass.logDebug("Class JMSClass already defined");}}if(typeof(JMSService)=="undefined"){JMSService=function(){JMSClass.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSService");}this.mpRegisteredServices=[];this.mpRegisteredServiceObj=[];};JMSService.prototype=new JMSClass;JMSService.prototype.toString=function(){return"JMSService()";};JMSService.prototype.getMyUrl=function(){return(window||this).location+"";};JMSService.prototype.bookmarkPage=function(url,name){if(window.sidebar){window.sidebar.addPanel(name,url,"");}else{if(document.all){window.external.AddFavorite(url,name);}else{alert('Dr�cke "'+(navigator.userAgent.toLowerCase().indexOf("mac")!=-1?"Command/Cmd":"CTRL")+' + D" um diese Seite zur den Favoriten hinzuzuf�gen.');}}};JMSService.prototype.writeCookie=function(name,value,days,path){if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}else{expires="";}document.cookie=name+"="+value+expires+"; path=/";};JMSService.prototype.readCookie=function(name){var nameFull=name+"=";var cookie=document.cookie;var ca=cookie.split(";");if(ca.length==0){ca=[cookie];}for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length);}if(c.indexOf(nameFull)==0){return c.substring(nameFull.length,c.length);}}return null;};JMSService.prototype.appendStyle=function(styles,parentId){var newStyle=document.createElement("style");newStyle.setAttribute("type","text/css");var flgDone=false;var parent=document.getElementById(parentId);if(parent){parent.appendChild(newStyle);if(newStyle.styleSheet){newStyle.styleSheet.cssText=styles;}else{var textStyles=document.createTextNode(styles);newStyle.appendChild(textStyles);}flgDone=true;}return flgDone;};JMSService.prototype.appendHtml=function(html,parentId,className){var newDiv=document.createElement("div");var flgDone=false;if(parentId){parentElement=document.getElementById(parentId);if(parentElement){parentElement.appendChild(newDiv);newDiv.innerHTML=html;if(className){newDiv.className=className;}flgDone=true;}}return flgDone;};JMSService.prototype.insertStyleBeforeScript=function(styles){var newStyle=document.createElement("style");newStyle.setAttribute("type","text/css");var flgDone=false;var firstScriptTag=document.getElementsByTagName("script")[0];if(firstScriptTag){firstScriptTag.parentNode.insertBefore(newStyle,firstScriptTag);if(newStyle.styleSheet){newStyle.styleSheet.cssText=styles;}else{var textStyles=document.createTextNode(styles);newStyle.appendChild(textStyles);}flgDone=true;}return flgDone;};JMSService.prototype.appendStyleAtEnd=function(styles){var newStyle=document.createElement("style");newStyle.setAttribute("type","text/css");var flgDone=false;var bodyTag=document.getElementsByTagName("body")[0];if(bodyTag){bodyTag.appendChild(newStyle);if(newStyle.styleSheet){newStyle.styleSheet.cssText=styles;}else{var textStyles=document.createTextNode(styles);newStyle.appendChild(textStyles);}flgDone=true;}return flgDone;};JMSService.prototype.addLinkOnClickEvent=function(classNames,event,force){try{for(var i=0;i<classNames.length;i++){var className=classNames[i];var links=document.getElementsByClassName(className);for(var j=0;j<links.length;j++){var link=links[j];if((!link.onclick)||force){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isDebug){this.jmsLoggerJMSService.logDebug("JMSService.addLinkOnClickEvent set a.onclick() for "+className+" Id:"+link.id+" with event");}link.onclickold=link.onclick;link.onclick=event;}else{if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isDebug){this.jmsLoggerJMSService.logDebug("JMSService.addLinkOnClickEvent cant set a.onclick() for "+className+" Id:"+link.id+" with event already defined");}}}}}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.addLinkOnClickEvent set a.onclick() Exception: "+ex);}}};JMSService.prototype.generateQR=function(url,block){try{var qr=new JSQR();var code=new qr.Code();code.encodeMode=code.ENCODE_MODE.UTF8_SIGNATURE;code.version=code.DEFAULT;code.errorCorrection=code.ERROR_CORRECTION.M;var input=new qr.Input();input.dataType=input.DATA_TYPE.URL;input.data={"url":url};var matrix=new qr.Matrix(input,code);var canvas=document.createElement("canvas");canvas.setAttribute("width",matrix.pixelWidth);canvas.setAttribute("height",matrix.pixelWidth);canvas.getContext("2d").fillStyle="rgb(0,0,0)";matrix.draw(canvas,0,0);document.getElementById(block).appendChild(canvas);}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.generateQR on "+block+" for "+url+" Exception: "+ex);}}};JMSService.prototype.isGeoLocationFromBrowserSupported=function(){var flg=false;try{if(navigator.geolocation){flg=true;}}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.isGeoLocationFromBrowserSupported Exception: "+ex);}}return flg;};JMSService.prototype.getGeoLocationFromBrowser=function(successRef,errorRef){var coord=null;try{if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function sucess(position){coord=position.coords.latitude+","+position.coords.longitude;if(JMSService.prototype.jmsLoggerJMSService&&JMSService.prototype.jmsLoggerJMSService.isDebug){JMSService.prototype.jmsLoggerJMSService.logDebug("JMSService.getGeoLocationFromBrowser Koordinaten: "+coord);}if(successRef){eval("successRef(coord)");}},function error(msg){if(JMSService.prototype.jmsLoggerJMSService&&JMSService.prototype.jmsLoggerJMSService.isDebug){JMSService.prototype.jmsLoggerJMSService.logDebug("JMSService.getGeoLocationFromBrowser ResultError: "+msg);}if(errorRef){eval("errorRef(msg)");}else{}},{maximumAge:360000,timeout:10000,enableHighAccuracy:true});}}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.getGeoLocationFromBrowser Exception: "+ex);}}return coord;};JMSService.prototype.isWebkitSpeechRecognitionFromBrowserSupported=function(){var flg=false;try{if("webkitSpeechRecognition" in window){flg=true;}}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.isWebkitSpeechRecognitionFromBrowserSupported Exception: "+ex);}}return flg;};JMSService.prototype.isDeviceNonDesktop=function(){var flg=false;try{}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.isDeviceNonDesktop Exception: "+ex);}}return flg;};JMSService.prototype.doActionIfNeedleFound=function(haystack,needle,action){var flgFound=false;if(haystack&&needle&&action){if(haystack.search(needle)>0){action(needle);flgFound=true;if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isDebug){this.jmsLoggerJMSService.logDebug("JMSService.doActionIfNeedleFound needle found:"+needle);}}}return flgFound;};JMSService.prototype.doActionIfNeedlesFound=function(haystack,lstNeedles,action){var flgFound=false;if(haystack&&lstNeedles&&action){for(var zaehler=0;zaehler<lstNeedles.length;zaehler++){var needle=lstNeedles[zaehler];flgFound=this.doActionIfNeedleFound(haystack,needle,action);if(flgFound){zaehler=lstNeedles.length+1;}}}return flgFound;};JMSService.prototype.registerService=function(name,url){if(!name||!url){this.doAlert("JMSService.registerService: name and srcFile required:"+name+" url:"+url);return null;}this.mpRegisteredServices[name]=url;};JMSService.prototype.loadRegisteredService=function(name){if(!name){this.doAlert("JMSService.loadRegisteredService: name required:"+name);return null;}var obj=false;if(this.mpRegisteredServices[name]){try{obj=this.stringToObject(name,"function");}catch(ex){var file=this.mpRegisteredServices[name];file=file.replace(/\\/g,"_");file=file.replace(/:/g,"_");if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isInfo){this.jmsLoggerJMSService.logInfo("JMSService.loadRegisteredService cant load Class:"+name+" Ex:"+ex);}ex=false;try{var tag=document.createElement("script");tag.src=file;var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isInfo){this.jmsLoggerJMSService.logInfo("JMSService.loadRegisteredService load Class:"+name+" from file:"+file);}}catch(ex){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.loadRegisteredService cant load Class:"+name+" from File:"+file+" Ex:"+ex);}}}}else{if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.loadRegisteredService Class not found:"+name);}}return obj;};JMSService.prototype.registerServiceObj=function(name,obj){if(!name||!obj){this.doAlert("JMSService.registerServiceObj: name and Obj required:"+name+" obj:"+obj);return null;}this.mpRegisteredServiceObj[name]=obj;};JMSService.prototype.getServiceObj=function(name){if(!name){this.doAlert("JMSService.getServiceObj: name required:"+name);return null;}var obj=this.mpRegisteredServiceObj[name];if(!obj){obj=this.loadRegisteredService(name);if(!obj){if(this.jmsLoggerJMSService&&this.jmsLoggerJMSService.isError){this.jmsLoggerJMSService.logError("JMSService.getServiceObj cant load Class:"+name);}}else{this.registerServiceObj(name,obj);}}return obj;};JMSService.prototype.stringToObject=function(str,type){type=type||"object";var arr=str.split(".");var fn=(window||this);for(var i=0,len=arr.length;i<len;i++){fn=fn[arr[i]];}if(typeof fn!==type){throw new Error("class"+str+" not found for: "+type+" existig:"+typeof fn);}var res=new fn;return res;};JMSService.prototype.jmsLoggerJMSService=false;}else{if(JMSService.prototype.jmsLoggerJMSService&&JMSService.prototype.jmsLoggerJMSService.isDebug){JMSService.prototype.jmsLoggerJMSService.logDebug("Class JMSService already defined");}}if(typeof(JMSBase)=="undefined"){JMSBase=function(){JMSClass.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSBase");}};JMSBase.prototype=new JMSClass;JMSBase.prototype.toString=function(){return"JMSBase()";};JMSBase.prototype.getJMSServiceObj=function(){return JMSBase.prototype.jmsService;};JMSBase.prototype.getServiceObj=function(name){return JMSBase.prototype.jmsService.getServiceObj(name);};JMSBase.prototype.jmsLoggerJMSBase=false;JMSBase.prototype.jmsService=new JMSService();}else{if(JMSBase.prototype.jmsLoggerJMSBase&&JMSBase.prototype.jmsLoggerJMSBase.isDebug){JMSBase.prototype.jmsLoggerJMSBase.logDebug("Class JMSBase already defined");}}if(typeof(JMSLayout)=="undefined"){JMSLayout=function(optimizePrintMode,optimize4Browser){JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSLayout");}this.optimizePrintMode=optimizePrintMode;this.optimize4Browser=optimize4Browser;var myUrl=this.getJMSServiceObj().getMyUrl();if(!this.optimize4Browser){if(myUrl.search("OPTIMIZEPRINT=A4WK")>0){this.optimize4Browser="WK";}}if(!this.optimizePrintMode){var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("OPTIMIZEPRINT=A4WK")>0){this.optimizePrintMode="A4WK";}}};JMSLayout.prototype=new JMSBase;JMSLayout.prototype.toString=function(){return"JMSLayout(optimizePrintMode="+this.optimizePrintMode+", optimize4Browser="+this.optimize4Browser+");";};JMSLayout.prototype.getMaxHeight=function(){var maxHeights=[888,888];if(this.optimizePrintMode=="A4WK"){maxHeights=[931,931];}return maxHeights;};JMSLayout.prototype.moveMapOnPage=function(boxlineDescId,boxDescPrintOptimizedId,boxlineDescPrinOptimizedId,mapId){var maxHeights=getMaxHeight();var maxHeight=maxHeights[0];var boxlineDesc=document.getElementById(boxlineDescId);var boxDescPrintOptimized=document.getElementById(boxDescPrintOptimizedId);var boxlineDescPrinOptimized=document.getElementById(boxlineDescPrinOptimizedId);var map=document.getElementById(mapId);if(boxlineDesc&&boxDescPrintOptimized&&boxlineDescPrinOptimized&&map){var mapYPos=map.offsetTop;var heightMap=map.offsetHeight+4;var maxYPos=maxHeight-heightMap;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.moveMapOnPage check mapId:"+mapId+" mapYPos:"+mapYPos+" heightMap:"+heightMap+" maxHeight:"+maxHeight+" maxYPos:"+maxYPos+" "+this);}while(mapYPos>maxYPos){var origDesc=boxlineDesc.innerHTML.toString();var newDesc=boxlineDescPrinOptimized.innerHTML.toString();var spacePos=0;while((res=origDesc.indexOf(" ",spacePos+1))>0){spacePos=res;}mapYPos=0;if(spacePos>0){boxDescPrintOptimized.style.display="block";fragment=origDesc.substring(spacePos,origDesc.length);newDesc=" "+fragment+newDesc;origDesc=origDesc.substring(0,spacePos);boxlineDesc.innerHTML=origDesc;boxlineDescPrinOptimized.innerHTML=newDesc;mapYPos=map.offsetTop;}if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.moveMapOnPage result mapId:"+mapId+" mapYPos:"+mapYPos+" "+this);}}}};JMSLayout.prototype.moveFullBlockOnPage=function(blockId,addOffset){var maxHeights=getMaxHeight();var maxHeight=maxHeights[0];var block=document.getElementById(blockId);if(block){var blockYPos=block.offsetTop;var heightDiv=block.offsetHeight;var maxYPos=maxHeight-heightDiv;if(blockYPos>maxYPos&&(blockYPos<maxHeight)){block.style.marginTop=maxYPos+heightDiv-blockYPos+addOffset;}}};JMSLayout.prototype.expandPageBreakBlockOnPage=function(blockId,blockPageBreakId,addOffset){var maxHeights=getMaxHeight();var maxHeight=maxHeights[0];var block=document.getElementById(blockId);var blockPageBreak=document.getElementById(blockPageBreakId);if(block&&blockPageBreak){var blockYPos=block.offsetTop;var heightDiv=block.offsetHeight;var maxYPos=maxHeight-heightDiv;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.expandPageBreakBlockOnPage check blockId:"+blockId+" blockYPos:"+blockYPos+" heightDiv:"+heightDiv+" maxHeight:"+maxHeight+" maxYPos:"+maxYPos+" "+this);}if(blockYPos>maxYPos&&(blockYPos<=maxHeight)){blockPageBreak.style.display="block";var dummyHeight=0;if(this.optimizePrintMode=="A4WK"){dummyHeight=maxYPos+heightDiv-blockYPos+addOffset;}else{dummyHeight=maxYPos+heightDiv-blockYPos+addOffset+10;}blockPageBreak.style.height=dummyHeight;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.expandPageBreakBlockOnPage move blockId:"+blockId+" dummyHeight:"+dummyHeight+" "+this);}if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.expandPageBreakBlockOnPage result blockId:"+blockId+" newYPos:"+block.offsetTop+" "+this);}}}};JMSLayout.prototype.insertPageBreakBlockOnPage=function(blockId,minOffset,addOffset){var maxHeights=getMaxHeight();var maxHeight1=maxHeights[0];var maxHeight2=maxHeights[1];var maxHeight=maxHeight1;var block=document.getElementById(blockId);if(block&&(block.style.display!="none")){var blockYPos=block.offsetTop;var heightDiv=block.offsetHeight;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.insertPageBreakBlockOnPage step1 blockId:"+blockId+" blockYPos:"+blockYPos+" minOffset:"+minOffset+" heightDiv:"+heightDiv+" maxHeight:"+maxHeight+" "+this);}if(heightDiv<minOffset){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.insertPageBreakBlockOnPage set minOffset=heightDiv blockId:"+blockId+" blockYPos:"+blockYPos+" minOffset:"+minOffset+" heightDiv:"+heightDiv+" maxHeight:"+maxHeight+" "+this);}minOffset=heightDiv;}var blockYPosSite=blockYPos;while(blockYPosSite>maxHeight){blockYPosSite=blockYPosSite-maxHeight;maxHeight=maxHeight2;}var maxYPosSite=maxHeight-minOffset;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.insertPageBreakBlockOnPage check blockId:"+blockId+" blockYPosSite:"+blockYPosSite+" minOffset:"+minOffset+" heightDiv:"+heightDiv+" maxHeight:"+maxHeight+" maxYPosSite:"+maxYPosSite+" "+this);}if(blockYPosSite>maxYPosSite&&(blockYPosSite<=maxHeight)){var blockPageBreak=document.createElement("div");blockPageBreak.style.padding="0px";blockPageBreak.style.margin="0px";blockPageBreak.style.clear="both";blockPageBreak.id=blockId+"-pagebreak-dyn";var parent=block.parentNode;parent.insertBefore(blockPageBreak,block);var dummyHeight=0;if(this.optimizePrintMode=="A4WK"){dummyHeight=(maxHeight-blockYPosSite+addOffset)+"px";}else{dummyHeight=(maxHeight-blockYPosSite+addOffset+10)+"px";}blockPageBreak.style.height=dummyHeight;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.insertPageBreakBlockOnPage insert blockId:"+blockId+" dummyHeight:"+dummyHeight+" "+this);}if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.insertPageBreakBlockOnPage result blockId:"+blockId+" newYPos:"+block.offsetTop+" "+this);}}}};JMSLayout.prototype.moveBlockOnPage=function(boxlineDescId,boxDescPrintOptimizedId,mapId){var maxHeights=getMaxHeight();var maxHeight=maxHeights[0];var boxlineDesc=document.getElementById(boxlineDescId);var boxDescPrintOptimized=document.getElementById(boxDescPrintOptimizedId);var map=document.getElementById(mapId);if(boxlineDesc&&boxDescPrintOptimized&&map){var mapYPos=map.offsetTop;var heightMap=map.offsetHeight+4;var maxYPos=maxHeight-heightMap;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.moveBlockOnPage check mapId:"+mapId+" mapYPos:"+mapYPos+" heightMap:"+heightMap+" maxHeight:"+maxHeight+" maxYPos:"+maxYPos+" "+this);}if(mapYPos>maxYPos){boxDescPrintOptimized.style.display="block";boxlineDescParent=boxlineDesc.parentNode.removeChild(boxlineDesc);boxDescPrintOptimized.appendChild(boxlineDesc);mapYPos=map.offsetTop;if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isDebug){this.jmsLoggerJMSLayout.logDebug("JMSLayout.moveBlockOnPage result mapId:"+mapId+" mapYPos:"+mapYPos+" moved Block:"+boxlineDescId+" to: "+boxDescPrintOptimizedId+" "+this);}}}};JMSLayout.prototype.togglerBlockSetVisibility=function(togglerBaseId,toggleId,flgVisible,js){if(!toggleId||!togglerBaseId){return null;}toggleElement=document.getElementById(toggleId);togglerElementOn=document.getElementById(togglerBaseId+"_On");togglerElementOff=document.getElementById(togglerBaseId+"_Off");if(!toggleElement){return null;}toggleDisplay="none";togglerOnDisplay="none";togglerOffDisplay="none";if(flgVisible){toggleDisplay="block";togglerOnDisplay="inline";togglerOffDisplay="none";}else{toggleDisplay="none";togglerOnDisplay="none";togglerOffDisplay="inline";}if(typeof js!="undefined"){js();}else{toggleElement.style.display=toggleDisplay;}if(togglerElementOn){togglerElementOn.style.display=togglerOnDisplay;}if(togglerElementOff){togglerElementOff.style.display=togglerOffDisplay;}};JMSLayout.prototype.togglerBlockHide=function(togglerBaseId,toggleId,js){curState=this.togglerBlockGetVisibility(toggleId);if(!curState){return;}return this.togglerBlockSetVisibility(togglerBaseId,toggleId,false,js);};JMSLayout.prototype.togglerBlockShow=function(togglerBaseId,toggleId,js){curState=this.togglerBlockGetVisibility(toggleId);if(curState){return;}return this.togglerBlockSetVisibility(togglerBaseId,toggleId,true,js);};JMSLayout.prototype.togglerBlockGetVisibility=function(toggleId){curState=true;if(!toggleId){return null;}toggleElement=document.getElementById(toggleId);if(!toggleElement){return null;}toggleDisplay=toggleElement.style.display;if(toggleDisplay=="none"){curState=false;}return curState;};JMSLayout.prototype.toggleBlock=function(togglerBaseId,toggleId,js){curState=this.togglerBlockGetVisibility(toggleId);if(curState){return this.togglerBlockHide(togglerBaseId,toggleId,js);}else{return this.togglerBlockShow(togglerBaseId,toggleId,js);}};JMSLayout.prototype.getInputRows=function(className){if(className){try{var lstInputRows=document.getElementsByClassName(className);return lstInputRows;}catch(ex){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isError){this.jmsLoggerJMSLayout.logError("JMSLayout.getInputRows error:"+ex);}}}return null;};JMSLayout.prototype.getInputIdsFromInputRow=function(eleInputRow){if(eleInputRow&&eleInputRow.getAttribute("inputids")){var lstInputIds=eleInputRow.getAttribute("inputids").split(",");return lstInputIds;}return null;};JMSLayout.prototype.getStateInputElement=function(eleInput){var state=false;if(eleInput.nodeName.toUpperCase()=="SELECT"){if(eleInput.value&&(eleInput.value!="search_all.php")){state=true;}else{for(var i=0;i<eleInput.length;i++){if(eleInput.options[i].selected&&eleInput.options[i].value&&(eleInput.options[i].value!="search_all.php")){state=true;i=eleInput.length+1;}}}}else{if(eleInput.nodeName.toUpperCase()=="INPUT"){if(eleInput.type.toUpperCase()=="RADIO"){if(eleInput.checked){state=true;}}else{if(eleInput.type.toUpperCase()=="CHECKBOX"){if(eleInput.checked){state=true;}}else{if(eleInput&&eleInput.value){state=true;}}}}}return state;};JMSLayout.prototype.getState4InputRow=function(eleInputRow){var lstInputIds=this.getInputIdsFromInputRow(eleInputRow);if(!lstInputIds||lstInputIds.length<=0){return false;}for(var i=0;i<lstInputIds.length;++i){var eleInputId=lstInputIds[i];var eleInput=document.getElementById(eleInputId);if(eleInput&&this.getStateInputElement(eleInput)){return true;}}return false;};JMSLayout.prototype.showHideInputRow=function(eleInputRow,forceShow){if(!eleInputRow){return false;}var state=this.getState4InputRow(eleInputRow);if(state||forceShow){this.showInputRow(eleInputRow);}else{this.hideInputRow(eleInputRow);}};JMSLayout.prototype.showInputRow=function(eleInputRow){if(!eleInputRow){return false;}eleInputRow.style.display="block";return true;};JMSLayout.prototype.hideInputRow=function(eleInputRow){if(!eleInputRow){return false;}eleInputRow.style.display="none";return false;};JMSLayout.prototype.showHideAllInputRows=function(className,forceShow){var lstInputRows=this.getInputRows(className);if(!lstInputRows||lstInputRows.length<=0){return null;}for(var i=0;i<lstInputRows.length;++i){var eleInputRow=lstInputRows[i];this.showHideInputRow(eleInputRow,forceShow);}};JMSLayout.prototype.resetInputElement=function(eleInput){if(eleInput.nodeName.toUpperCase()=="SELECT"){if(eleInput.value){eleInput.value="";}for(var i=0;i<eleInput.length;i++){if(eleInput.options[i].selected&&eleInput.options[i].value){eleInput.options[i].selected=false;}}}else{if(eleInput.nodeName.toUpperCase()=="INPUT"){if(eleInput.type.toUpperCase()=="RADIO"){if(eleInput.checked){eleInput.checked=false;}}else{if(eleInput.type.toUpperCase()=="CHECKBOX"){if(eleInput.checked){eleInput.checked=true;}}else{if(eleInput&&eleInput.value){eleInput.value="";}}}}}return true;};JMSLayout.prototype.resetInputRow=function(eleInputRow){var lstInputIds=this.getInputIdsFromInputRow(eleInputRow);if(!lstInputIds||lstInputIds.length<=0){return false;}for(var i=0;i<lstInputIds.length;++i){var eleInputId=lstInputIds[i];var eleInput=document.getElementById(eleInputId);if(eleInput){this.resetInputElement(eleInput);}}return true;};JMSLayout.prototype.toggleElementOnPosition=function(id,event){var element=document.getElementById(id);if(element){var state=element.style.display;if(state!="block"){state="block";}else{state="none";}element.style.display=state;if(!event){event=window.event;}var posX=event.pageX;var posY=event.pageY;var width=element.offsetWidth;var height=element.offsetHeight;var maxX=window.innerWidth;if((posX+width>maxX)){posX=maxX-width;}if((posX<1)){posX=1;}var maxY=window.innerHeight;if((posY+height>maxY)){posY=maxY-height;}if((posY<1)){posY=1;}if(document.layers&&event){element.left=posX;element.top=posY;}else{if(document.getElementById&&event){element.style.left=posX+"px";element.style.top=posY+"px";}}}};JMSLayout.prototype.showNumberRangeSlider=function(idElemMin,idElemMax,idSlider,min,max){try{$(function(){try{var curMin=$("#"+idElemMin).val();if(!curMin||curMin<min){curMin=min;}var curMax=$("#"+idElemMax).val();if(!curMax||curMax>max){curMax=max;}$("#"+idSlider).slider({range:true,min:min,max:max,values:[curMin,curMax],slide:function(event,ui){cur=ui.values[0];if(cur==min){cur="";}$("#"+idElemMin).val(cur);cur=ui.values[1];if(cur==max){cur="";}$("#"+idElemMax).val(cur);}});if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isInfo){this.jmsLoggerJMSLayout.logInfo("JMSLayout.showNumberRangeSlider added Slider:"+idSlider);}}catch(ex){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isError){this.jmsLoggerJMSLayout.logError("JMSLayout.showNumberRangeSlider error:"+ex);}}});}catch(ex){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isError){this.jmsLoggerJMSLayout.logError("JMSLayout.showNumberRangeSlider error:"+ex);}}};JMSLayout.prototype.showSelectRangeSlider=function(idElemMin,idElemMax,idSlider,defaultValue){try{$(function(){try{var min=1;var max=$("#"+idElemMin)[0].options.length+1;var curMin=null;if(idElemMin&&$("#"+idElemMin)){curMin=$("#"+idElemMin)[0].selectedIndex+1;}if(!curMin||curMin==defaultValue){curMin=min;}var curMax=null;if(idElemMax&&$("#"+idElemMax)){curMax=$("#"+idElemMax)[0].selectedIndex+1;}if(!curMax||curMax==defaultValue){curMax=max;}var flgRange=false;var values=new Array();values.push(curMin);if(idElemMin&&idElemMax){flgRange=true;values.push(curMax);}$("#"+idSlider).slider({range:flgRange,min:min,max:max,values:values,slide:function(event,ui){cur=ui.values[0];if(cur==defaultValue){cur=defaultValue;}if(idElemMin&&$("#"+idElemMin)){$("#"+idElemMin)[0].selectedIndex=cur-1;}cur=ui.values[1];if(idElemMax&&$("#"+idElemMax)){if(cur>$("#"+idElemMin)[0].options.length){cur=defaultValue;}$("#"+idElemMax)[0].selectedIndex=cur-1;}}});if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isInfo){this.jmsLoggerJMSLayout.logInfo("JMSLayout.showSelectRangeSlider added Slider:"+idSlider);}}catch(ex){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isError){this.jmsLoggerJMSLayout.logError("JMSLayout.showNumberRangeSlider error:"+ex);}}});}catch(ex){if(this.jmsLoggerJMSLayout&&this.jmsLoggerJMSLayout.isError){this.jmsLoggerJMSLayout.logError("JMSLayout.showNumberRangeSlider error:"+ex);}}};JMSLayout.prototype.jmsLoggerJMSLayout=false;}else{if(JMSLayout.prototype.jmsLoggerJMSLayout&&JMSLayout.prototype.jmsLoggerJMSLayout.isDebug){JMSLayout.prototype.jmsLoggerJMSLayout.logDebug("Class JMSLayout already defined");}}var JMS_CONST_GEO_OsmZoomLevels=Array();JMS_CONST_GEO_OsmZoomLevels.push(1);JMS_CONST_GEO_OsmZoomLevels.push(360);JMS_CONST_GEO_OsmZoomLevels.push("whole world ");JMS_CONST_GEO_OsmZoomLevels.push(156412);JMS_CONST_GEO_OsmZoomLevels.push(1);JMS_CONST_GEO_OsmZoomLevels.push(180);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(78206);JMS_CONST_GEO_OsmZoomLevels.push(2);JMS_CONST_GEO_OsmZoomLevels.push(90);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(39103);JMS_CONST_GEO_OsmZoomLevels.push(3);JMS_CONST_GEO_OsmZoomLevels.push(45);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(19551);JMS_CONST_GEO_OsmZoomLevels.push(4);JMS_CONST_GEO_OsmZoomLevels.push(22.5);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(9776);JMS_CONST_GEO_OsmZoomLevels.push(5);JMS_CONST_GEO_OsmZoomLevels.push(11.25);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(4888);JMS_CONST_GEO_OsmZoomLevels.push(6);JMS_CONST_GEO_OsmZoomLevels.push(5.625);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(2444);JMS_CONST_GEO_OsmZoomLevels.push(7);JMS_CONST_GEO_OsmZoomLevels.push(2.813);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(1222);JMS_CONST_GEO_OsmZoomLevels.push(8);JMS_CONST_GEO_OsmZoomLevels.push(1.406);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(610.984);JMS_CONST_GEO_OsmZoomLevels.push(9);JMS_CONST_GEO_OsmZoomLevels.push(0.703);JMS_CONST_GEO_OsmZoomLevels.push("wide area ");JMS_CONST_GEO_OsmZoomLevels.push(305.492);JMS_CONST_GEO_OsmZoomLevels.push(10);JMS_CONST_GEO_OsmZoomLevels.push(0.352);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(152.746);JMS_CONST_GEO_OsmZoomLevels.push(11);JMS_CONST_GEO_OsmZoomLevels.push(0.176);JMS_CONST_GEO_OsmZoomLevels.push("area ");JMS_CONST_GEO_OsmZoomLevels.push(76.373);JMS_CONST_GEO_OsmZoomLevels.push(12);JMS_CONST_GEO_OsmZoomLevels.push(0.088);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(38.187);JMS_CONST_GEO_OsmZoomLevels.push(13);JMS_CONST_GEO_OsmZoomLevels.push(0.044);JMS_CONST_GEO_OsmZoomLevels.push("village or town ");JMS_CONST_GEO_OsmZoomLevels.push(19.093);JMS_CONST_GEO_OsmZoomLevels.push(14);JMS_CONST_GEO_OsmZoomLevels.push(0.022);JMS_CONST_GEO_OsmZoomLevels.push("largest editable area on the applet ");JMS_CONST_GEO_OsmZoomLevels.push(9.547);JMS_CONST_GEO_OsmZoomLevels.push(15);JMS_CONST_GEO_OsmZoomLevels.push(0.011);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(4.773);JMS_CONST_GEO_OsmZoomLevels.push(16);JMS_CONST_GEO_OsmZoomLevels.push(0.005);JMS_CONST_GEO_OsmZoomLevels.push("small road ");JMS_CONST_GEO_OsmZoomLevels.push(2.387);JMS_CONST_GEO_OsmZoomLevels.push(17);JMS_CONST_GEO_OsmZoomLevels.push(0.003);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(1.193);JMS_CONST_GEO_OsmZoomLevels.push(18);JMS_CONST_GEO_OsmZoomLevels.push(0.001);JMS_CONST_GEO_OsmZoomLevels.push("");JMS_CONST_GEO_OsmZoomLevels.push(0.596);if(typeof(JMSGeoLatLon)=="undefined"){JMSGeoLatLon=function(pLat,pLon){JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoLatLon");}this.flLat=parseFloat(pLat);this.flLon=parseFloat(pLon);this.lat=pLat;this.lon=pLon;};JMSGeoLatLon.prototype=new JMSBase;JMSGeoLatLon.prototype.toString=function(){return"JMSGeoLatLon("+this.flLat+","+this.flLon+")";};JMSGeoLatLon.prototype.convert2OpenLayersLonLat=function(projectionObj){var lonLat=new OpenLayers.LonLat(this.flLon,this.flLat).transform(new OpenLayers.Projection("EPSG:4326"),projectionObj);return lonLat;};JMSGeoLatLon.prototype.convert2OpenLayersPoint=function(projectionObj){var data=this.convertToMercator();var point=new OpenLayers.Geometry.Point(data[0],data[1]);return point;};JMSGeoLatLon.prototype.convert2GLatLng=function(){var latLon=new GLatLng(this.flLat,this.flLon);return latLon;};JMSGeoLatLon.prototype.convert2G3LatLng=function(){var latLon=new google.maps.LatLng(this.flLat,this.flLon);return latLon;};JMSGeoLatLon.prototype.convert2BingLatLng=function(){var latLon=new Microsoft.Maps.Location(this.flLat,this.flLon);return latLon;};JMSGeoLatLon.prototype.convert2Array=function(){var latLon=new Array(this.flLon,this.flLat);return latLon;};JMSGeoLatLon.prototype.createArray=function(flLon,flLat){var latLon=new Array(flLon,flLat);return latLon;};JMSGeoLatLon.prototype.convertToMercator=function(){x=parseFloat(this.flLon);y=parseFloat(this.flLat);var PI=3.141592653589793;x=x*20037508.34/180;y=Math.log(Math.tan((90+y)*PI/360))/(PI/180);y=y*20037508.34/180;return new Array(x,y);};JMSGeoLatLon.prototype.getXtreme=function(objJMSGeoLatLon,type){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("getXtreme(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);return null;}var lat1=(this.flLat!=null?parseFloat(this.flLat):null);var lon1=(this.flLon!=null?parseFloat(this.flLon):null);var latNew=lat1;var lonNew=lon1;if(objJMSGeoLatLon){var lat2=(objJMSGeoLatLon.flLat!=null?parseFloat(objJMSGeoLatLon.flLat):null);var lon2=(objJMSGeoLatLon.flLon!=null?parseFloat(objJMSGeoLatLon.flLon):null);if(type>0){if(lat2>lat1){latNew=lat2;}if(lon2>lon1){lonNew=lon2;}}else{if(lat2<lat1){latNew=lat2;}if(lon2<lon1){lonNew=lon2;}}}var extreme=new JMSGeoLatLon(latNew,lonNew);if(this.jmsLoggerJMSGeoLatLon&&this.jmsLoggerJMSGeoLatLon.isDebug){this.jmsLoggerJMSGeoLatLon.logDebug("JMSGeoLatLon.getXtreme type:"+type+" me:"+this+" and:"+objJMSGeoLatLon+" to:"+extreme);}return extreme;};JMSGeoLatLon.prototype.getMin=function(objJMSGeoLatLon){return this.getXtreme(objJMSGeoLatLon,-1);};JMSGeoLatLon.prototype.getMax=function(objJMSGeoLatLon){return this.getXtreme(objJMSGeoLatLon,1);};JMSGeoLatLon.prototype.distance=function(objJMSGeoLatLon){var Geographic=new OpenLayers.Projection("EPSG:4326");var Mercator=new OpenLayers.Projection("EPSG:900913");var point1=new OpenLayers.Geometry.Point(this.lon,this.lat).transform(Geographic,Mercator);var point2=new OpenLayers.Geometry.Point(objJMSGeoLatLon.lon,objJMSGeoLatLon.lat).transform(Geographic,Mercator);var line=new OpenLayers.Geometry.LineString([point1,point2]);var pointdist=line.getGeodesicLength(Mercator);return pointdist;};JMSGeoLatLon.prototype.getZoomLevel=function(objJMSGeoLatLon,minZoom,mapWidth,mapHeight){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("getZoomLevel(objJMSGeoLatLon, minZoom) is no JMSGeoLatLon: "+objJMSGeoLatLon);return null;}var zoom=14;if(minZoom&&minZoom>0){zoom=minZoom;}var latZoom=zoom;var lonZoom=zoom;var pmpLatLonLeft=this.getMin(objJMSGeoLatLon);var pmpLatLonRight=this.getMax(objJMSGeoLatLon);var latDiff=pmpLatLonRight.lat-pmpLatLonLeft.lat;latDiff=latDiff*1.8;var lonDiff=pmpLatLonRight.lon-pmpLatLonLeft.lon;var mapWidthFaktor=1;if(mapWidth<400){mapWidthFaktor=0.5;}var mapHeightFaktor=1;if(mapHeight<300){mapHeightFaktor=0.5;}for(var j=0;j<JMS_CONST_GEO_OsmZoomLevels.length/4;j++){var curLevel=JMS_CONST_GEO_OsmZoomLevels[j*4];var curDeg=JMS_CONST_GEO_OsmZoomLevels[j*4+1];curDeg=curDeg*mapWidthFaktor;if(latDiff>(curDeg*mapWidthFaktor)&&latZoom>curLevel){latZoom=curLevel;}if(lonDiff>(curDeg*mapHeightFaktor)&&lonZoom>curLevel){lonZoom=curLevel;}}if(latZoom<zoom){zoom=latZoom;}if(lonZoom<zoom){zoom=lonZoom;}var result=new Array(latZoom,lonZoom,zoom);if(this.jmsLoggerJMSGeoLatLon&&this.jmsLoggerJMSGeoLatLon.isDebug){this.jmsLoggerJMSGeoLatLon.logDebug("JMSGeoLatLon.getZoomLevel minZoom:"+minZoom+" me:"+this+" and:"+objJMSGeoLatLon+" to:"+result);}return result;};JMSGeoLatLon.prototype.getCenter=function(objJMSGeoLatLon){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("getCenter(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);return null;}var pmpLatLonLeft=this.getMin(objJMSGeoLatLon);var pmpLatLonRight=this.getMax(objJMSGeoLatLon);var newLat=pmpLatLonLeft.lat+(pmpLatLonRight.lat-pmpLatLonLeft.lat)/2;var newLon=pmpLatLonLeft.lon+(pmpLatLonRight.lon-pmpLatLonLeft.lon)/2;var center=new JMSGeoLatLon(newLat,newLon);if(this.jmsLoggerJMSGeoLatLon&&this.jmsLoggerJMSGeoLatLon.isDebug){this.jmsLoggerJMSGeoLatLon.logDebug("JMSGeoLatLon.getCenter me:"+this+" and:"+objJMSGeoLatLon+" to:"+center);}return center;};JMSGeoLatLon.prototype.jmsLoggerJMSGeoLatLon=false;}else{if(JMSGeoLatLon.prototype.jmsLoggerJMSGeoLatLon&&JMSGeoLatLon.prototype.jmsLoggerJMSGeoLatLon.isDebug){JMSGeoLatLon.prototype.jmsLoggerJMSGeoLatLon.logDebug("Class JMSGeoLatLon already defined");}}if(typeof(JMSGeoLatLonEleTime)=="undefined"){JMSGeoLatLonEleTime=function(pLat,pLon,pEle,pTime){JMSGeoLatLon.call(this,pLat,pLon);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoLatLonEleTime");}this.flEle=null;if(pEle){this.flEle=parseFloat(pEle);}this.ele=pEle;this.time=pTime;};JMSGeoLatLonEleTime.prototype=new JMSGeoLatLon;JMSGeoLatLonEleTime.prototype.toString=function(){return"JMSGeoLatLonEleTime("+this.flLat+","+this.flLon+","+this.flEle+","+this.time+")";};JMSGeoLatLonEleTime.prototype.convert2ArrayFull=function(){var latLon=new Array(this.flLon,this.flLat,this.flEle,this.time);return latLon;};JMSGeoLatLonEleTime.prototype.createArrayFull=function(flLon,flLat,flEle,time){var latLon=new Array(flLon,flLat,flEle,time);return latLon;};JMSGeoLatLonEleTime.prototype.getXtreme=function(objJMSGeoLatLonEleTime,type){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLonEleTime&&!this.checkInstanceOf(objJMSGeoLatLonEleTime,"JMSGeoLatLonEleTime")){this.logError("getXtreme(objJMSGeoLatLonEleTime) is no JMSGeoLatLonEleTime: "+objJMSGeoLatLonEleTime);return null;}var lat1=(this.flLat!=null?parseFloat(this.flLat):null);var lon1=(this.flLon!=null?parseFloat(this.flLon):null);var ele1=(this.flEle!=null?parseFloat(this.flEle):null);var time1=this.time;var latNew=lat1;var lonNew=lon1;var eleNew=ele1;var timeNew=time1;if(objJMSGeoLatLonEleTime){var lat2=(objJMSGeoLatLonEleTime.flLat!=null?parseFloat(objJMSGeoLatLonEleTime.flLat):null);var lon2=(objJMSGeoLatLonEleTime.flLon!=null?parseFloat(objJMSGeoLatLonEleTime.flLon):null);var ele2=(objJMSGeoLatLonEleTime.flEle!=null?parseFloat(objJMSGeoLatLonEleTime.flEle):null);var time2=objJMSGeoLatLonEleTime.time;if(type>0){if(lat2>lat1){latNew=lat2;}if(lon2>lon1){lonNew=lon2;}if(ele2>ele1){eleNew=ele2;}if(time2>time1){timeNew=time2;}}else{if(lat2<lat1){latNew=lat2;}if(lon2<lon1){lonNew=lon2;}if(ele2<ele1){eleNew=ele2;}if(time2<time1){timeNew=time2;}}}var extreme=new JMSGeoLatLonEleTime(latNew,lonNew,eleNew,timeNew);if(this.jmsLoggerJMSGeoLatLonEleTime&&this.jmsLoggerJMSGeoLatLonEleTime.isDebug){this.jmsLoggerJMSGeoLatLonEleTime.logDebug("JMSGeoLatLonEleTime.getXtreme type:"+type+" me:"+this+" and:"+objJMSGeoLatLonEleTime+" to:"+extreme);}return extreme;};JMSGeoLatLonEleTime.prototype.getCenter=function(objJMSGeoLatLonEleTime){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLonEleTime&&!this.checkInstanceOf(objJMSGeoLatLonEleTime,"JMSGeoLatLonEleTime")){this.logError("getCenter(objJMSGeoLatLonEleTime) is no JMSGeoLatLonEleTime: "+objJMSGeoLatLonEleTime);return null;}var pmpLatLonLeft=this.getMin(objJMSGeoLatLonEleTime);var pmpLatLonRight=this.getMax(objJMSGeoLatLonEleTime);var newLat=pmpLatLonLeft.lat+(pmpLatLonRight.lat-pmpLatLonLeft.lat)/2;var newLon=pmpLatLonLeft.lon+(pmpLatLonRight.lon-pmpLatLonLeft.lon)/2;var newEle=pmpLatLonLeft.ele+(pmpLatLonRight.ele-pmpLatLonLeft.ele)/2;var newTime=pmpLatLonLeft.time+(pmpLatLonRight.time-pmpLatLonLeft.time)/2;var center=new JMSGeoLatLonEleTime(newLat,newLon,newEle,newTime);if(this.jmsLoggerJMSGeoLatLonEleTime&&this.jmsLoggerJMSGeoLatLonEleTime.isDebug){this.jmsLoggerJMSGeoLatLonEleTime.logDebug("JMSGeoLatLonEleTime.getCenter me:"+this+" and:"+objJMSGeoLatLonEleTime+" to:"+center);}return center;};JMSGeoLatLonEleTime.prototype.jmsLoggerJMSGeoLatLonEleTime=false;}else{if(JMSGeoLatLonEleTime.prototype.jmsLoggerJMSGeoLatLonEleTime&&JMSGeoLatLonEleTime.prototype.jmsLoggerJMSGeoLatLonEleTime.isDebug){JMSGeoLatLonEleTime.prototype.jmsLoggerJMSGeoLatLonEleTime.logDebug("Class JMSGeoLatLonEleTime already defined");}}MPLonLat=function(pLon,pLat){JMSGeoLatLon.call(this,pLat,pLon);if(this.FLG_CHECK_CLASSES){this.setClassName("MPLonLat");}};MPLonLat.prototype=new JMSGeoLatLon;MPLonLat.prototype.construcor=MPLonLat;JMSGeoLonLat=function(pLon,pLat){JMSGeoLatLon.call(this,pLat,pLon);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoLonLat");}};JMSGeoLonLat.prototype=new JMSGeoLatLon;JMSGeoLonLat.prototype.construcor=JMSGeoLonLat;if(typeof(JMSGeoMapFeature)=="undefined"){JMSGeoMapFeature=function(strType,id,pFeature,pHshData,infoUrl){JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeature");}this.strType=strType;this.id=id;this.objFeature=pFeature;this.hshData=pHshData;this.infoWindowHtmlContent=null;this.objJMSGeoMap=null;this.infoUrl=infoUrl;this.flgHide=false;};JMSGeoMapFeature.prototype=new JMSBase;JMSGeoMapFeature.prototype.construcor=JMSGeoMapFeature;JMSGeoMapFeature.TYPE_LOADINFOWINDOW_SERVER=1;JMSGeoMapFeature.TYPE_LOADINFOWINDOW_LOCAL=0;JMSGeoMapFeature.prototype.toString=function(){var ret="JMSGeoMapFeature(Id:"+this.getId()+",Type:"+this.getType();ret=ret+",Data"+this.hshData;ret=ret+",OBJ:"+this.getFeatureObj()+")";return ret;};JMSGeoMapFeature.prototype.close=function(){this.getJMSGeoMapObj().removeFeature(this.getFeatureObj(),this.getConfig()["layerName"]);this.hshData=null;this.objFeature=null;this.infoWindowHtmlContent=null;};JMSGeoMapFeature.prototype.hide=function(){if(this.flgHide==false){this.getJMSGeoMapObj().hideFeature(this.getFeatureObj(),this.getConfig()["layerName"]);}this.flgHide=true;};JMSGeoMapFeature.prototype.unhide=function(){if(this.flgHide==true){this.getJMSGeoMapObj().unhideFeature(this.getFeatureObj(),this.getConfig()["layerName"]);}this.flgHide=false;};JMSGeoMapFeature.prototype.toggle=function(){if(this.flgHide==true){this.unhide();}else{this.hide();}};JMSGeoMapFeature.prototype.getId=function(){return this.id;};JMSGeoMapFeature.prototype.getType=function(){return this.strType;};JMSGeoMapFeature.prototype.getDataValue=function(strName){return this.hshData[strName];};JMSGeoMapFeature.prototype.setDataValue=function(strName,value){return this.hshData[strName]=value;};JMSGeoMapFeature.prototype.getFeatureObj=function(){return this.objFeature;};JMSGeoMapFeature.prototype.setFeatureObj=function(pObjFeature){if(pObjFeature){if(!pObjFeature.data){pObjFeature.data={};}pObjFeature.data.mpFeatureObj=this;}this.objFeature=pObjFeature;};JMSGeoMapFeature.prototype.getJMSGeoMapObj=function(){return this.objJMSGeoMap;};JMSGeoMapFeature.prototype.setJMSGeoMapObj=function(objJMSGeoMap){if(this.FLG_CHECK_CLASSES&&objJMSGeoMap&&!this.checkInstanceOf(objJMSGeoMap,"JMSGeoMap")){this.logError("setJMSGeoMapObj(ObjMap) is no JMSGeoMap: "+objJMSGeoMap);objJMSGeoMap=null;}this.objJMSGeoMap=objJMSGeoMap;};JMSGeoMapFeature.prototype.getStrName=function(){return this.getDataValue("NAME");};JMSGeoMapFeature.prototype.getStrHtmldesc=function(){return this.getDataValue("HTMLDESC");};JMSGeoMapFeature.prototype.getLatLon=function(){return this.getDataValue("LATLON");};JMSGeoMapFeature.prototype.getConfig=function(){var cfg={};if(this.getDataValue("CONFIG")){cfg=this.getDataValue("CONFIG");}return cfg;};JMSGeoMapFeature.prototype.getInfoWindowHtmlContent=function(){return this.infoWindowHtmlContent;};JMSGeoMapFeature.prototype.setInfoWindowHtmlContent=function(infoWindowHtmlContent){this.infoWindowHtmlContent=infoWindowHtmlContent;};JMSGeoMapFeature.prototype.openInfoWindow=function(){var mapObj=this.getJMSGeoMapObj();var loadInfoWindowType=this.getConfig()["loadInfoWindowType"];if(mapObj&&this.infoUrl&&loadInfoWindowType==JMSGeoMapFeature.TYPE_LOADINFOWINDOW_SERVER){if(this.jmsLoggerJMSGeoMapFeature&&this.jmsLoggerJMSGeoMapFeature.isDebug){this.jmsLoggerJMSGeoMapFeature.logDebug("JMSGeoMapFeature.openInfoWindow load Data from Server me:"+this+" url:"+this.infoUrl);}var mpInfoWindowLoad=new JMSGeoMapFeatureInfoWindowLoad(this,null,this.infoUrl,this.getLatLon());mpInfoWindowLoad.load();}else{if(this.jmsLoggerJMSGeoMapFeature&&this.jmsLoggerJMSGeoMapFeature.isDebug){this.jmsLoggerJMSGeoMapFeature.logDebug("JMSGeoMapFeature.openInfoWindow with lokal data me:"+this);}var content=this.getInfoWindowHtmlContent();this.getFeatureObj().popup=mapObj.openInfoWindow(this.getLatLon(),"Info",content);}};JMSGeoMapFeature.prototype.jmsLoggerJMSGeoMapFeature=false;}else{if(JMSGeoMapFeature.prototype.jmsLoggerJMSGeoMapFeature&&JMSGeoMapFeature.prototype.jmsLoggerJMSGeoMapFeature.isDebug){JMSGeoMapFeature.prototype.jmsLoggerJMSGeoMapFeature.logDebug("Class JMSGeoMapFeature already defined");}}if(typeof(JMSGeoMapFeatureLocation)=="undefined"){JMSGeoMapFeatureLocation=function(id,objFeature,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("JMSGeoMapFeatureLocation(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);objJMSGeoLatLon=null;return null;}JMSGeoMapFeature.call(this,"LOCATION",id,objFeature,{"NAME":strName,"HTMLDESC":strhtmlDesc,"LATLON":objJMSGeoLatLon,"CONFIG":hshConfig},"./ajaxhtml_loc4id.php?L_ID="+id);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureLocation");}};JMSGeoMapFeatureLocation.prototype=new JMSGeoMapFeature;JMSGeoMapFeatureLocation.prototype.construcor=JMSGeoMapFeatureLocation;JMSGeoMapFeatureLocation.prototype.centerMapOnFeature=function(mpMap,minZoom,forceSecondTime){if(this.FLG_CHECK_CLASSES&&mpMap&&!this.checkInstanceOf(mpMap,"JMSGeoMap")){this.logError("centerMapOnFeature(mpMap, minZoom, forceSecondTime) mpMap is no JMSGeoMap: "+mpMap);return null;}var zoom=14;if(minZoom&&minZoom>0&&minZoom<zoom){zoom=minZoom;}mpMap.setCenter(this.getDataValue("LATLON"),minZoom);};JMSGeoMapFeatureLocation.prototype.jmsLoggerJMSGeoMapFeatureLocation=false;}else{if(JMSGeoMapFeatureLocation.prototype.jmsLoggerJMSGeoMapFeatureLocation&&JMSGeoMapFeatureLOcation.prototype.jmsLoggerJMSGeoMapFeatureLocation.isDebug){JMSGeoMapFeatureLocation.prototype.jmsLoggerJMSGeoMapFeatureLocation.logDebug("Class JMSGeoMapFeatureLocation already defined");}}if(typeof(JMSGeoMapFeatureLocationArea)=="undefined"){JMSGeoMapFeatureLocationArea=function(id,objFeature,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("JMSGeoMapFeatureLocationArea(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);objJMSGeoLatLon=null;return null;}JMSGeoMapFeature.call(this,"LOCATIONAREA",id,objFeature,{"NAME":strName,"HTMLDESC":strhtmlDesc,"LATLON":objJMSGeoLatLon,"ARRLATLON":arrObjJMSGeoLatLon,"CONFIG":hshConfig},"./ajaxhtml_loc4id.php?L_ID="+id);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureLocationArea");}};JMSGeoMapFeatureLocationArea.prototype=new JMSGeoMapFeature;JMSGeoMapFeatureLocationArea.prototype.construcor=JMSGeoMapFeatureLocationArea;JMSGeoMapFeatureLocationArea.prototype.centerMapOnFeature=function(mpMap,minZoom,forceSecondTime){if(this.FLG_CHECK_CLASSES&&mpMap&&!this.checkInstanceOf(mpMap,"JMSGeoMap")){this.logError("centerMapOnFeature(mpMap, minZoom, forceSecondTime) mpMap is no JMSGeoMap: "+mpMap);return null;}var zoom=14;if(minZoom&&minZoom>0&&minZoom<zoom){zoom=minZoom;}mpMap.setCenter(this.getDataValue("LATLON"),minZoom);};JMSGeoMapFeatureLocationArea.prototype.getArrJMSGeoLatLon=function(){return this.getDataValue("ARRLATLON");};JMSGeoMapFeatureLocationArea.prototype.jmsLoggerJMSGeoMapFeatureLocationArea=false;}else{if(JMSGeoMapFeatureLocationArea.prototype.jmsLoggerJMSGeoMapFeatureLocationArea&&JMSGeoMapFeatureLocationArea.prototype.jmsLoggerJMSGeoMapFeatureLocationArea.isDebug){JMSGeoMapFeatureLocationArea.prototype.jmsLoggerJMSGeoMapFeatureLocationArea.logDebug("Class JMSGeoMapFeatureLocationArea already defined");}}if(typeof(JMSGeoMapFeatureTour)=="undefined"){JMSGeoMapFeatureTour=function(id,objFeature,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){var url=null;if(id){url="./ajaxhtml_tour4id.php?T_ID="+id;}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("JMSGeoMapFeatureTour(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);objJMSGeoLatLon=null;return null;}JMSGeoMapFeature.call(this,"TOUR",id,objFeature,{"NAME":strName,"HTMLDESC":strhtmlDesc,"LATLON":objJMSGeoLatLon,"ARRLATLON":arrObjJMSGeoLatLon,"CONFIG":hshConfig},url);this.metaBounds=null;this.metaAsc=null;this.metaDist=null;this.metaDesc=null;this.metaLstProfile=null;if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureTour");}};JMSGeoMapFeatureTour.prototype=new JMSGeoMapFeatureLocation;JMSGeoMapFeatureTour.prototype.construcor=JMSGeoMapFeatureTour;JMSGeoMapFeatureTour.prototype.getArrJMSGeoLatLon=function(){return this.getDataValue("ARRLATLON");};JMSGeoMapFeatureTour.prototype.initMetaData=function(){var curArrLatLon=this.getArrJMSGeoLatLon();if(curArrLatLon&&!this.metaLstProfile){var objMin=curArrLatLon[0];var objMax=curArrLatLon[0];var lastPoint=null;var x=0;this.metaLstProfile=new Array();for(var j=0;j<curArrLatLon.length;j++){var curObj=curArrLatLon[j];objMin=objMin.getMin(curObj);objMax=objMax.getMax(curObj);var ele=curObj.flEle;if(lastPoint){var dist=lastPoint.distance(curObj);x=x+dist/1000;if(ele>0&&lastPoint.flEle){diff=ele-lastPoint.flEle;if(diff>0){this.metaAsc+=diff;}else{if(diff<0){this.metaDesc+=-diff;}}}}if(ele!=0){this.metaLstProfile.push([x,ele]);}lastPoint=curObj;}this.metaBounds=new Array(objMin,objMax);this.metaDist=x;}};JMSGeoMapFeatureTour.prototype.getBoundsJMSGeoLatLon=function(flgWithStart){var boundLastLon=null;this.initMetaData();if(this.metaBounds){var objMin=this.metaBounds[0];var objMax=this.metaBounds[1];var startLatLon=this.getDataValue("LATLON");if(startLatLon&&flgWithStart){objMin=objMin.getMin(startLatLon);objMax=objMax.getMax(startLatLon);}boundLastLon=new Array(objMin,objMax);}if(this.jmsLoggerJMSGeoMapFeatureTour&&this.jmsLoggerJMSGeoMapFeatureTour.isDebug){this.jmsLoggerJMSGeoMapFeatureTour.logDebug("JMSGeoMapFeatureTour.getBoundsJMSGeoLatLon me:"+this+" flgWithStart:"+flgWithStart+" to:"+boundLastLon);}return boundLastLon;};JMSGeoMapFeatureTour.prototype.centerMapOnFeature=function(mpMap,minZoom,forceSecondTime){if(this.FLG_CHECK_CLASSES&&mpMap&&!this.checkInstanceOf(mpMap,"JMSGeoMap")){this.logError("centerMapOnFeature(mpMap, minZoom, forceSecondTime) mpMap is no JMSGeoMap: "+mpMap);return null;}var bounds=this.getBoundsJMSGeoLatLon(true);if(bounds&&bounds.length==2){mpMap.setBounds(bounds[0],bounds[1],minZoom,forceSecondTime);}};JMSGeoMapFeatureTour.prototype.jmsLoggerJMSGeoMapFeatureTour=false;}else{if(JMSGeoMapFeatureTour.prototype.jmsLoggerJMSGeoMapFeatureTour&&JMSGeoMapFeatureTour.prototype.jmsLoggerJMSGeoMapFeatureTour.isDebug){JMSGeoMapFeatureTour.prototype.jmsLoggerJMSGeoMapFeatureTour.logDebug("Class JMSGeoMapFeatureTour already defined");}}if(typeof(JMSGeoMapFeatureTrack)=="undefined"){JMSGeoMapFeatureTrack=function(id,objFeature,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){var url=null;if(id){url="./ajaxhtml_kat4id.php?K_ID="+id;}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("JMSGeoMapFeatureTrack(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);objJMSGeoLatLon=null;return null;}JMSGeoMapFeature.call(this,"TRACK",id,objFeature,{"NAME":strName,"HTMLDESC":strhtmlDesc,"LATLON":objJMSGeoLatLon,"ARRLATLON":arrObjJMSGeoLatLon,"CONFIG":hshConfig},url);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureTrack");}};JMSGeoMapFeatureTrack.prototype=new JMSGeoMapFeatureTour;JMSGeoMapFeatureTrack.prototype.construcor=JMSGeoMapFeatureTrack;JMSGeoMapFeatureTrack.prototype.jmsLoggerJMSGeoMapFeatureTrack=false;}else{if(JMSGeoMapFeatureTrack.prototype.jmsLoggerJMSGeoMapFeatureTrack&&JMSGeoMapFeatureTrack.prototype.jmsLoggerJMSGeoMapFeatureTrack.isDebug){JMSGeoMapFeatureTrack.prototype.jmsLoggerJMSGeoMapFeatureTrack.logDebug("Class JMSGeoMapFeatureTrack already defined");}}if(typeof(JMSGeoMapFeatureImage)=="undefined"){JMSGeoMapFeatureImage=function(id,objFeature,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig){var url="./ajaxhtml_pics4pos.php?LAT="+objJMSGeoLatLon.lat+"&LONG="+objJMSGeoLatLon.lon;if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("JMSGeoMapFeatureImage(objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon);objJMSGeoLatLon=null;return null;}JMSGeoMapFeature.call(this,"IMAGE",id,objFeature,{"NAME":strName,"HTMLDESC":strhtmlDesc,"LATLON":objJMSGeoLatLon,"CONFIG":hshConfig},url);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureImage");}};JMSGeoMapFeatureImage.prototype=new JMSGeoMapFeatureLocation;JMSGeoMapFeatureImage.prototype.construcor=JMSGeoMapFeatureImage;JMSGeoMapFeatureImage.prototype.jmsLoggerJMSGeoMapFeatureImage=false;}else{if(JMSGeoMapFeatureImage.prototype.jmsLoggerJMSGeoMapFeatureImage&&JMSGeoMapFeatureImage.prototype.jmsLoggerJMSGeoMapFeatureImage.isDebug){JMSGeoMapFeatureImage.prototype.jmsLoggerJMSGeoMapFeatureImage.logDebug("Class JMSGeoMapFeatureImage already defined");}}if(typeof(JMSGeoMap)=="undefined"){JMSGeoMap=function(pstrHtmlElementId,phshConfig,phshMapConfig){JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMap");}this.objMap=null;this.strHtmlElementId=pstrHtmlElementId;this.hshConfig={};if(phshConfig){this.hshConfig=phshConfig;}this.hshMapConfig={};if(phshMapConfig){this.hshMapConfig=phshMapConfig;}this.hshLayer={};this.hshFeature={};this.flgHideFeature={};this.hshFeature["LOCATION"]=[];this.hshFeature["LOCATIONAREA"]=[];this.hshFeature["IMAGE"]=[];this.hshFeature["TOUR"]=[];this.hshFeature["TRACK"]=[];this.flgHideFeature["LOCATION"]=false;this.flgHideFeature["LOCATIONAREA"]=false;this.flgHideFeature["IMAGE"]=false;this.flgHideFeature["TOUR"]=false;this.flgHideFeature["TRACK"]=false;this.viewRectangle=null;this.osmSearchObj=null;this.flgCenterSet=0;};JMSGeoMap.prototype=new JMSBase;JMSGeoMap.prototype.construcor=JMSGeoMap;JMSGeoMap.prototype.toString=function(){return"JMSGeoMap(divId:"+this.strHtmlElementId+")";};JMSGeoMap.prototype.destroy=function(){this.hshFeature=null;};JMSGeoMap.prototype.getMapObj=function(){return this.objMap;};JMSGeoMap.prototype.getConfig=function(){return this.hshConfig;};JMSGeoMap.prototype.getMapConfig=function(){return this.hshMapConfig;};JMSGeoMap.prototype.callFullScreenFuncRef=function(){if(this.getConfig().fullScreenFuncRef){if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.fullScreenFuncRef me:"+this);}this.getConfig().fullScreenFuncRef.apply(this,this);}};JMSGeoMap.prototype.hasFullScreenFuncRef=function(){if(this.getConfig().fullScreenFuncRef){return true;}return false;};JMSGeoMap.prototype.createJMSGeoLatLonObj=function(pLat,pLon,pEle,pTime){return new JMSGeoLatLon(pLat,pLon);};JMSGeoMap.prototype.addLayer=function(strName,layerObj){this.addLayer2Map(layerObj);this.hshLayer[strName]=layerObj;};JMSGeoMap.prototype.getLayer=function(strName){return this.hshLayer[strName];};JMSGeoMap.prototype.addOsmLocSearch=function(globalMapVarName){this.osmSearchObj=new JMSGeoMapOsmLocSearchWindow(this,globalMapVarName+".osmSearchObj.");};JMSGeoMap.prototype.getOsmLocSearchObj=function(){return this.osmSearchObj;};JMSGeoMap.prototype.addJMSGeoMapFeature=function(strType,id,featureObj){var tmpHash=this.hshFeature[strType];if(!tmpHash){tmpHash={};this.hshFeature[strType]=tmpHash;}if(this.FLG_CHECK_CLASSES&&featureObj&&!this.checkInstanceOf(featureObj,"JMSGeoMapFeature")){this.logError("addJMSGeoMapFeature(featureObj) is no JMSGeoMapFeature: "+featureObj);return null;}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addJMSGeoMapFeature me:"+this+" featureObj:"+featureObj);}if(id&&id!="null"){var oldJMSGeoMapFeature=tmpHash[id];if(oldJMSGeoMapFeature){oldJMSGeoMapFeature.close();oldJMSGeoMapFeature=null;tmpHash[id]=null;}}featureObj.flgHide=this.flgHideFeature[strType];tmpHash[id]=featureObj;featureObj.setJMSGeoMapObj(this);};JMSGeoMap.prototype.getJMSGeoMapFeature=function(strType,id){var tmpHash=this.hshFeature[strType];var element=null;if(tmpHash){element=tmpHash[id];}return element;};JMSGeoMap.prototype.addLocation=function(id,strNameLayer,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig){if(!id||id=="null)"){id=strName+"Pos:"+objJMSGeoLatLon.toString();}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("addLocation(id, objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon+" Id:"+id);return null;}var mpFeature=this.getJMSGeoMapFeature("LOCATION",id);if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addLocation me:"+this+" id:"+id+" strNameLayer:"+strNameLayer+" strName:"+strName+"  objJMSGeoLatLon:"+objJMSGeoLatLon);}if(this.isEmpty(mpFeature)){mpFeature=new JMSGeoMapFeatureLocation(id,null,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig);mpFeature.setInfoWindowHtmlContent("<p><strong>Ort: "+mpFeature.getStrName()+"</strong><br />"+mpFeature.getStrHtmldesc()+"</p>");mpFeature.getConfig()["layerName"]=strNameLayer;this.addJMSGeoMapFeature("LOCATION",id,mpFeature);var objFeature=this.addFeatureLocation2Map(strNameLayer,mpFeature);mpFeature.setFeatureObj(objFeature);}return mpFeature;};JMSGeoMap.prototype.addLocationArea=function(id,strNameLayer,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){if(!id||id=="null)"){id=strName+"Pos:"+objJMSGeoLatLon.toString();}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("addLocationArea(id, objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon+" Id:"+id);return null;}var mpFeature=this.getJMSGeoMapFeature("LOCATIONAREA",id);if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addLocationArea me:"+this+" id:"+id+" strNameLayer:"+strNameLayer+" strName:"+strName+"  objJMSGeoLatLon:"+objJMSGeoLatLon);}if(this.isEmpty(mpFeature)){mpFeature=new JMSGeoMapFeatureLocationArea(id,null,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig);mpFeature.setInfoWindowHtmlContent("<p><strong>Region: "+mpFeature.getStrName()+"</p>");mpFeature.getConfig()["layerName"]=strNameLayer;this.addJMSGeoMapFeature("LOCATIONAREA",id,mpFeature);var objFeature=this.addFeatureLocationArea2Map(strNameLayer,mpFeature);mpFeature.setFeatureObj(objFeature);}return mpFeature;};JMSGeoMap.prototype.addTour=function(id,strNameLayer,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){if(!id||id=="null)"){id=strName+"Pos:"+objJMSGeoLatLon.toString();}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("addTour(id, objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon+" Id:"+id);return null;}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addTour me:"+this+" id:"+id+" strNameLayer:"+strNameLayer+" strName:"+strName+"  objJMSGeoLatLon:"+objJMSGeoLatLon);}var mpFeature=this.getJMSGeoMapFeature("TOUR",id);if(this.isEmpty(mpFeature)){mpFeature=new JMSGeoMapFeatureTour(id,null,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig);var colorStr=mpFeature.getConfig()["color"];if(colorStr){colorStr="<div style='background-color:"+colorStr+";'>&nbsp;&nbsp;</div>";}mpFeature.setInfoWindowHtmlContent("<p><strong>Tour: "+mpFeature.getStrName()+"</strong>"+colorStr+"<br />"+mpFeature.getStrHtmldesc()+"</p>");mpFeature.getConfig()["layerName"]=strNameLayer;this.addJMSGeoMapFeature("TOUR",id,mpFeature);var objFeature=this.addFeatureTour2Map(strNameLayer,mpFeature,1);mpFeature.setFeatureObj(objFeature);}return mpFeature;};JMSGeoMap.prototype.addTrack=function(id,strNameLayer,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig){if(!id||id=="null)"){id=strName+"Pos:"+objJMSGeoLatLon.toString();}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("addTrack(id, objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon+" Id:"+id);return null;}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addTrack me:"+this+" id:"+id+" strNameLayer:"+strNameLayer+" strName:"+strName+"  objJMSGeoLatLon:"+objJMSGeoLatLon);}var mpFeature=this.getJMSGeoMapFeature("TRACK",id);if(this.isEmpty(mpFeature)){mpFeature=new JMSGeoMapFeatureTrack(id,null,strName,strhtmlDesc,objJMSGeoLatLon,arrObjJMSGeoLatLon,hshConfig);var colorStr=mpFeature.getConfig()["color"];if(colorStr){colorStr="<div style='background-color:"+colorStr+";'>&nbsp;&nbsp;</div>";}mpFeature.setInfoWindowHtmlContent("<p><strong>Ausflug: "+mpFeature.getStrName()+"</strong>"+colorStr+"<br />"+mpFeature.getStrHtmldesc()+"</p>");mpFeature.getConfig()["layerName"]=strNameLayer;this.addJMSGeoMapFeature("TRACK",id,mpFeature);var objFeature=this.addFeatureTrack2Map(strNameLayer,mpFeature,0);mpFeature.setFeatureObj(objFeature);}return mpFeature;};JMSGeoMap.prototype.addImage=function(id,strNameLayer,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig){if(!id||id=="null)"){id=strName+"Pos:"+objJMSGeoLatLon.toString();}if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(objJMSGeoLatLon,"JMSGeoLatLon")){this.logError("addImage(id, objJMSGeoLatLon) is no JMSGeoLatLon: "+objJMSGeoLatLon+" Id:"+id);return null;}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.addIMage me:"+this+" id:"+id+" strNameLayer:"+strNameLayer+" strName:"+strName+"  objJMSGeoLatLon:"+objJMSGeoLatLon);}var mpFeature=this.getJMSGeoMapFeature("IMAGE",id);if(this.isEmpty(mpFeature)){mpFeature=new JMSGeoMapFeatureImage(id,null,strName,strhtmlDesc,objJMSGeoLatLon,hshConfig);mpFeature.setInfoWindowHtmlContent("<p><strong>Bilder: "+mpFeature.getStrName()+"</strong><br />"+mpFeature.getStrHtmldesc()+"</p>");mpFeature.getConfig()["layerName"]=strNameLayer;this.addJMSGeoMapFeature("IMAGE",id,mpFeature);var objFeature=this.addFeatureImage2Map(strNameLayer,mpFeature);mpFeature.setFeatureObj(objFeature);}return mpFeature;};JMSGeoMap.prototype.randomColor=function(){var hex=new Array("0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F");var color="#";for(i=0;i<6;i++){color+=hex[Math.floor(Math.random()*hex.length)];}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.randomColor me:"+this+" color:"+color);}return color;};JMSGeoMap.prototype.randomMapSourceColor=function(){var gMapColors=new Array("Red","Green","Yellow","Blue","DarkGray","Magenta","Cyan","LightGray","DarkRed","DarkGreen","DarkYellow","DarkBlue","DarkMagenta","DarkCyan","Black");var color="";color=gMapColors[Math.floor(Math.random()*gMapColors.length)];if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.randomMapSourceColor me:"+this+" color:"+color);}return color;};JMSGeoMap.prototype.hideJMSGeoMapFeatures=function(strType){var tmpHash=this.hshFeature[strType];if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.hideJMSGeoMapFeatures me:"+this+" strType:"+strType);}if(tmpHash&&this.flgHideFeature[strType]==false){this.flgHideFeature[strType]=true;for(var i in tmpHash){var mpFeatureObj=tmpHash[i];if(!this.isEmpty(mpFeatureObj)&&mpFeatureObj){mpFeatureObj.hide();}}}};JMSGeoMap.prototype.unhideJMSGeoMapFeatures=function(strType){var tmpHash=this.hshFeature[strType];if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.unhideJMSGeoMapFeatures me:"+this+" strType:"+strType);}if(tmpHash&&this.flgHideFeature[strType]==true){this.flgHideFeature[strType]=false;for(var i in tmpHash){var mpFeatureObj=tmpHash[i];if(!this.isEmpty(mpFeatureObj)&&mpFeatureObj){mpFeatureObj.unhide();}}}};JMSGeoMap.prototype.toggleJMSGeoMapFeatures=function(strType){var tmpHash=this.hshFeature[strType];if(this.flgHideFeature[strType]){this.unhideJMSGeoMapFeatures(strType);}else{this.hideJMSGeoMapFeatures(strType);}};JMSGeoMap.prototype.removeJMSGeoMapFeatures=function(strType){var tmpHash=this.hshFeature[strType];if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.removeJMSGeoMapFeatures me:"+this+" strType:"+strType);}if(tmpHash){for(var i in tmpHash){var mpFeatureObj=tmpHash[i];if(!this.isEmpty(mpFeatureObj)&&mpFeatureObj){mpFeatureObj.close();}}this.hshFeature[strType]=null;}};JMSGeoMap.prototype.setBounds=function(pmpLatLonLeft,pmpLatLonRight,minZoom,forceSecondTime){if(this.FLG_CHECK_CLASSES&&pmpLatLonLeft&&!this.checkInstanceOf(pmpLatLonLeft,"JMSGeoLatLon")){this.logError("setBounds(pmpLatLonLeft, pmpLatLonRight) pmpLatLonLeft is no JMSGeoLatLon: "+pmpLatLonLeft);return null;}if(this.FLG_CHECK_CLASSES&&pmpLatLonRight&&!this.checkInstanceOf(pmpLatLonRight,"JMSGeoLatLon")){this.logError("setBounds(pmpLatLonLeft, pmpLatLonRight) pmpLatLonRight is no JMSGeoLatLon: "+pmpLatLonRight);return null;}if(this.flgCenterSet&&!forceSecondTime){if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.setBounds already set me:"+this+" pmpLatLonLeft:"+pmpLatLonLeft+" pmpLatLonRight:"+pmpLatLonRight+" minZoom:"+minZoom+" forceSecondTime:"+forceSecondTime);}return null;}this.flgCenterSet=1;var center=pmpLatLonLeft.getCenter(pmpLatLonRight);var width=580;var height=400;var ele=document.getElementById(this.strHtmlElementId);if(ele){width=ele.offsetWidth;height=ele.offsetHeight;}var lstZoomLevels=pmpLatLonRight.getZoomLevel(pmpLatLonLeft,minZoom,width,height);var zoom=lstZoomLevels[2];if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.setBounds set new center:"+center+" zoom: "+zoom+" me:"+this+" pmpLatLonLeft:"+pmpLatLonLeft+" pmpLatLonRight:"+pmpLatLonRight+" minZoom:"+minZoom+" forceSecondTime:"+forceSecondTime);}this.setCenter(center,zoom);};JMSGeoMap.prototype.getFeatureBoundsJMSGeoLatLon=function(featureType){var objMin=null;var objMax=null;var lstLocFeatures=new Array();if(!featureType||featureType=="IMAGE"){lstLocFeatures.push(featureType);}if(!featureType||featureType=="LOCATION"){lstLocFeatures.push(featureType);}if(!featureType||featureType=="TOUR"){lstLocFeatures.push(featureType);}if(!featureType||featureType=="TRACK"){lstLocFeatures.push(featureType);}for(var i=0;i<lstLocFeatures.length;i++){var strType=lstLocFeatures[i];var lstFeatureObj=this.hshFeature[strType];if(lstFeatureObj){for(var id in lstFeatureObj){var curFeatureObj=lstFeatureObj[id];var myMin=null;var myMax=null;if(strType=="LOCATION"||strType=="IMAGE"){myMin=curFeatureObj.getDataValue("LATLON");myMax=myMin;}else{var myBounds=curFeatureObj.getBoundsJMSGeoLatLon(false);myMin=myBounds[0];myMax=myBounds[1];}if(objMin){objMin=objMin.getMin(myMin);}else{objMin=myMin;}if(objMax){objMax=objMax.getMax(myMax);}else{objMax=myMax;}if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.getFeatureBoundsJMSGeoLatLon id:"+id+" to:"+myBounds);}}}}var boundsLatLon=new Array(objMin,objMax);if(this.jmsLoggerJMSGeoMap&&this.jmsLoggerJMSGeoMap.isDebug){this.jmsLoggerJMSGeoMap.logDebug("JMSGeoMap.getFeatureBoundsJMSGeoLatLon me:"+this+" to:"+boundsLatLon);}return boundsLatLon;};JMSGeoMap.prototype.removeFeature=function(objFeature,strNameLayer){alert("Please Override me removeFeature :-)");};JMSGeoMap.prototype.hideFeature=function(objFeature,strNameLayer){alert("Please Override me hideFeature :-)");};JMSGeoMap.prototype.unhideFeature=function(objFeature,strNameLayer){alert("Please Override me unhideFeature :-)");};JMSGeoMap.prototype.createMapObj=function(){alert("Please Override me createMapObj :-)");};JMSGeoMap.prototype.openInfoWindow=function(pos,name,content){alert("Please Override me openInfoWindow :-)");};JMSGeoMap.prototype.openStatusWindow=function(name,content){alert("Please Override me openStatusWindow :-)");};JMSGeoMap.prototype.closeStatusWindow=function(popup){alert("Please Override me closeStatusWindow :-)");};JMSGeoMap.prototype.addDefaultControls=function(){alert("Please Override me addDefaultControls :-)");};JMSGeoMap.prototype.addJMSGeoMapFeatureControls=function(){alert("Please Override me addJMSGeoMapFeatureControls :-)");};JMSGeoMap.prototype.setCenter=function(pmpLatLonCenter,zoom){alert("Please Override me setCenter :-)");};JMSGeoMap.prototype.getCenter=function(){alert("Please Override me getCenter :-)");return null;};JMSGeoMap.prototype.getZoom=function(){alert("Please Override me getZoom :-)");return null;};JMSGeoMap.prototype.addFeatureLocation2Map=function(strNameLayer,mpFeatureLocation){alert("Please Override me addFeatureLocation2Map :-)");return{"ID":mpFeatureLocation.getId()};};JMSGeoMap.prototype.addFeatureLocationArea2Map=function(strNameLayer,mpFeatureLocationArea){alert("Please Override me addFeatureLocationArea2Map :-)");return{"ID":mpFeatureLocationArea.getId()};};JMSGeoMap.prototype.addFeatureTour2Map=function(strNameLayer,mpFeatureTour,flgTour){alert("Please Override me addFeatureTour2Map :-)");return{"ID":mpFeatureTour.getId()};};JMSGeoMap.prototype.addFeatureTrack2Map=function(strNameLayer,mpFeatureTrack){if(this.FLG_CHECK_CLASSES&&objJMSGeoLatLon&&!this.checkInstanceOf(mpFeatureTrack,"JMSGeoMapFeatureTrack")){this.logError("addFeatureTrack2Map(mpFeatureTrack) is no JMSGeoMapFeatureTrack: "+mpFeatureTrack);return null;}return this.addFeatureTour2Map(strNameLayer,mpFeatureTrack);};JMSGeoMap.prototype.addFeatureImage2Map=function(strNameLayer,mpFeatureImage){alert("Please Override me addFeatureImage2Map :-)");return{"ID":mpFeatureImage.getId()};};JMSGeoMap.prototype.setViewRectangle=function(strNameLayer,zoomLat,zoomLon){alert("Please Override me addFeatureImage2Map :-)");};JMSGeoMap.prototype.addLayer2Map=function(objLayer){alert("Please Override me addLayer2Map :-)");};JMSGeoMap.prototype.registerMapEvent=function(event,functionRef){alert("Please Override me registerMapEvent :-)");};JMSGeoMap.prototype.registerJMSGeoMapFeatureEvent=function(mpFeature,event,functionRef){alert("Please Override me registerJMSGeoMapFeatureEvent :-)");};JMSGeoMap.prototype.addRoutenEditor=function(textAreaId,layerName){alert("Please Override me addRoutenEditor :-)");};JMSGeoMap.prototype.jmsLoggerJMSGeoMap=false;}else{if(JMSGeoMap.prototype.jmsLoggerJMSGeoMap&&JMSGeoMap.prototype.jmsLoggerJMSGeoMap.isDebug){JMSGeoMap.prototype.jmsLoggerJMSGeoMap.logDebug("Class JMSGeoMap already defined");}}if(typeof(JMSGeoMapDocLoad)=="undefined"){JMSGeoMapDocLoad=function(objMap,strNameLayer,url,statusInfoText){if(this.FLG_CHECK_CLASSES&&objMap&&!this.checkInstanceOf(objMap,"JMSGeoMap")){this.logError("JMSGeoMapDocLoad(objMap) is no JMSGeoMap: "+objMap);return null;}JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapDocLoad");}this.objMap=objMap;this.strNameLayer=strNameLayer;if(url){url=url.replace(/&amp;/g,"&");}this.url=url;this.statusInfoText=statusInfoText;this.statusInfoPopup=null;};JMSGeoMapDocLoad.prototype=new JMSBase;JMSGeoMapDocLoad.prototype.construcor=JMSGeoMapDocLoad;JMSGeoMapDocLoad.prototype.getJMSGeoMapObj=function(){return this.objMap;};JMSGeoMapDocLoad.prototype.load=function(){if(this.statusInfoText){this.statusInfoPopup=this.getJMSGeoMapObj().openStatusWindow("Lade Daten...",this.statusInfoText);}if(this.jmsLoggerJMSGeoMapDocLoad&&this.jmsLoggerJMSGeoMapDocLoad.isDebug){this.jmsLoggerJMSGeoMapDocLoad.logDebug("JMSGeoMapDocLoad.load me:"+this+" url:"+this.url);}var results=OpenLayers.loadURL(this.url,null,this,this.requestSuccess,this.requestError);};JMSGeoMapDocLoad.prototype.requestFailure=function(request){if(this.statusInfoPopup){this.getJMSGeoMapObj().closeStatusWindow(this.statusInfoPopup);}var msg="requestFailure for url:"+this.url+" Request:"+request;if(this.jmsLoggerJMSGeoMapDocLoad&&this.jmsLoggerJMSGeoMapDocLoad.isDebug){this.jmsLoggerJMSGeoMapDocLoad.logDebug("JMSGeoMapDocLoad.requestFailure me:"+this+" "+msg);}alert(msg);return 0;};JMSGeoMapDocLoad.prototype.requestSuccess=function(request){var doc=request.responseText;if(this.statusInfoPopup){this.getJMSGeoMapObj().closeStatusWindow(this.statusInfoPopup);}if(this.jmsLoggerJMSGeoMapDocLoad&&this.jmsLoggerJMSGeoMapDocLoad.isDebug){this.jmsLoggerJMSGeoMapDocLoad.logDebug("JMSGeoMapDocLoad.requestSuccess me:"+this+" url:"+this.url);}};JMSGeoMapDocLoad.prototype.jmsLoggerJMSGeoMapDocLoad=false;}else{if(JMSGeoMapDocLoad.prototype.jmsLoggerJMSGeoMapDocLoad&&JMSGeoMapDocLoad.prototype.jmsLoggerJMSGeoMapDocLoad.isDebug){JMSGeoMapDocLoad.prototype.jmsLoggerJMSGeoMapDocLoad.logDebug("Class JMSGeoMapDocLoad already defined");}}if(typeof(JMSGeoMapJsLoad)=="undefined"){JMSGeoMapJsLoad=function(objMap,strNameLayer,url,statusInfoText){JMSGeoMapDocLoad.call(this,objMap,strNameLayer,url,statusInfoText);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapJsLoad");}};JMSGeoMapJsLoad.prototype=new JMSGeoMapDocLoad;JMSGeoMapJsLoad.prototype.construcor=JMSGeoMapJsLoad;JMSGeoMapJsLoad.prototype.requestSuccess=function(request){if(this.jmsLoggerJMSGeoMapJsLoad&&this.jmsLoggerJMSGeoMapJsLoad.isDebug){this.jmsLoggerJMSGeoMapJsLoad.logDebug("JMSGeoMapJsLoad.requestSuccess me:"+this+" url:"+this.url);}var doc=request.responseText;if(doc){if(document.createElement&&document.childNodes){try{doc=doc.replace(/GPoint/gi,"JMSGeoLonLat");eval(doc);}catch(e){alert("Exception "+e+" Download: "+this.url);}}}if(this.statusInfoPopup){this.getJMSGeoMapObj().closeStatusWindow(this.statusInfoPopup);}};JMSGeoMapJsLoad.prototype.jmsLoggerJMSGeoMapJsLoad=false;}else{if(JMSGeoMapJsLoad.prototype.jmsLoggerJMSGeoMapJsLoad&&JMSGeoMapJsLoad.prototype.jmsLoggerJMSGeoMapJsLoad.isDebug){JMSGeoMapJsLoad.prototype.jmsLoggerJMSGeoMapJsLoad.logDebug("Class JMSGeoMapJsLoad already defined");}}if(typeof(JMSGeoMapFeatureInfoWindowLoad)=="undefined"){JMSGeoMapFeatureInfoWindowLoad=function(mpFeatureObj,strNameLayer,url,pos){if(this.FLG_CHECK_CLASSES&&mpFeatureObj&&!this.checkInstanceOf(mpFeatureObj,"JMSGeoMapFeature")){this.logError("JMSGeoMapFeatureInfoWindowLoad(mpFeatureObj) is no JMSGeoMapFeature: "+mpFeatureObj);return null;}JMSGeoMapDocLoad.call(this,mpFeatureObj.getJMSGeoMapObj(),strNameLayer,url);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapFeatureInfoWindowLoad");}this.mpFeatureObj=mpFeatureObj;this.pos=pos;};JMSGeoMapFeatureInfoWindowLoad.prototype=new JMSGeoMapDocLoad;JMSGeoMapFeatureInfoWindowLoad.prototype.construcor=JMSGeoMapFeatureInfoWindowLoad;JMSGeoMapFeatureInfoWindowLoad.prototype.requestSuccess=function(request){var doc=request.responseText;if(this.jmsLoggerJMSGeoMapFeatureInfoWindowLoad&&this.jmsLoggerJMSGeoMapFeatureInfoWindowLoad.isDebug){this.jmsLoggerJMSGeoMapFeatureInfoWindowLoad.logDebug("JMSGeoMapFeatureInfoWindowLoad.requestSuccess me:"+this+" url:"+this.url);}if(doc){if(document.createElement&&document.childNodes){try{var colorStr=this.mpFeatureObj.getConfig()["color"];if(colorStr){colorStr="<div style='background-color:"+colorStr+";'>&nbsp;&nbsp;</div>";doc="<p>"+colorStr+"</p>"+doc;}var popup=this.mpFeatureObj.getJMSGeoMapObj().openInfoWindow(this.pos,"Info",doc);this.mpFeatureObj.getFeatureObj().popup=popup;}catch(e){alert("Exception "+e+" Show Content from: "+this.url);}}}if(this.statusInfoPopup){this.getJMSGeoMapObj().closeStatusWindow(this.statusInfoPopup);}};JMSGeoMapFeatureInfoWindowLoad.prototype.jmsLoggerJMSGeoMapFeatureInfoWindowLoad=false;}else{if(JMSGeoMapFeatureInfoWindowLoad.prototype.jmsLoggerJMSGeoMapFeatureInfoWindowLoad&&JMSGeoMapFeatureInfoWindowLoad.prototype.jmsLoggerJMSGeoMapFeatureInfoWindowLoad.isDebug){JMSGeoMapFeatureInfoWindowLoad.prototype.jmsLoggerJMSGeoMapFeatureInfoWindowLoad.logDebug("Class JMSGeoMapFeatureInfoWindowLoad already defined");}}if(typeof(JMSGeoMapGPXLoad)=="undefined"){JMSGeoMapGPXLoad=function(objMap,strNameLayer,url,statusInfoText){JMSGeoMapDocLoad.call(this,objMap,strNameLayer,url,statusInfoText);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapGPXLoad");}};JMSGeoMapGPXLoad.prototype=new JMSGeoMapDocLoad;JMSGeoMapGPXLoad.prototype.construcor=JMSGeoMapGPXLoad;JMSGeoMapGPXLoad.prototype.requestSuccess=function(request){if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.requestSuccess me:"+this+" url:"+this.url);}var doc=request.responseXML;if(!doc||request.fileType!="XML"){doc=OpenLayers.parseXMLString(request.responseText);}if(typeof doc=="string"){doc=OpenLayers.parseXMLString(doc);}if(doc){this.parseXMLDocument(doc);}if(this.statusInfoPopup){this.getJMSGeoMapObj().closeStatusWindow(this.statusInfoPopup);}return 0;};JMSGeoMapGPXLoad.prototype.parseXMLDocument=function(doc){var constTagNameWpt="wpt";var constTagNameRte="rte";var constTagNameRtept="rtept";var constTagNameEle="ele";var constTagNameTime="time";if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.parseXMLDocument me:"+this+" url:"+this.url);}if(doc){if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.parseXMLDocument valid document parsing Waypoints me:"+this+" url:"+this.url);}var lstTags=doc.getElementsByTagName(constTagNameWpt);for(var i=0;i<lstTags.length;i++){var color=this.getJMSGeoMapObj().randomColor();var style_green={strokeColor:color,strokeOpacity:1,strokeWidth:4,pointRadius:6,pointerEvents:"visiblePainted"};var tag=lstTags[i];var lstChildTags=tag.childNodes;var pointList=[];var data={};var title="Wegpunkt";var description="Keine Beschreibung.";for(var j=0;j<lstChildTags.length;j++){var childTag=lstChildTags[j];var nodeName=childTag.nodeName;switch(nodeName){case"topografix:color":color="#"+OpenLayers.Util.getXmlNodeValue(childTag);break;case"color":color="#"+OpenLayers.Util.getXmlNodeValue(childTag);break;case"name":title=OpenLayers.Util.getXmlNodeValue(childTag);break;case"desc":description=OpenLayers.Util.getXmlNodeValue(childTag);if(description){description=description.replace(/\n/g,"<br>");}break;case"#text":break;break;default:break;}}var geoPoint=this.getJMSGeoMapObj().createJMSGeoLatLonObj(tag.getAttribute("lat"),tag.getAttribute("lon"));if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.parseXMLDocument add Waypoint me:"+this+" url:"+this.url+" title:"+title+" geo:"+geoPoint);}this.getJMSGeoMapObj().addLocation(null,this.strNameLayer,title,description,geoPoint,{loadInfoWindowType:JMSGeoMapFeature.TYPE_LOADINFOWINDOW_LOCAL});}var lstTags=doc.getElementsByTagName(constTagNameRte);if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.parseXMLDocument valid document parsing Routes me:"+this+" url:"+this.url+" LstRTE:"+lstTags.length);}var lstFeatures=[];for(var i=0;i<lstTags.length;i++){var color=this.getJMSGeoMapObj().randomColor();var tag=lstTags[i];var lstChildTags=tag.childNodes;var startPoint=null;var pointList=[];var title="Route";var description="Keine Beschreibung.";for(var j=0;j<lstChildTags.length;j++){var childTag=lstChildTags[j];var nodeName=childTag.nodeName;switch(nodeName){case"topografix:color":color=OpenLayers.Util.getXmlNodeValue(childTag);break;case"color":color=OpenLayers.Util.getXmlNodeValue(childTag);break;case constTagNameRtept:if(color==""){color=this.getJMSGeoMapObj().randomColor();}if(childTag.getAttribute("lat")&&childTag.getAttribute("lon")){var ele=0;var time=null;var lstRtpChildTags=childTag.childNodes;for(var k=0;k<lstRtpChildTags.length;k++){var rtpChildTag=lstRtpChildTags[k];var rtpNodeName=rtpChildTag.nodeName;switch(rtpNodeName){case constTagNameEle:ele=OpenLayers.Util.getXmlNodeValue(rtpChildTag);break;case constTagNameTime:time=OpenLayers.Util.getXmlNodeValue(rtpChildTag);break;default:break;}}var point=this.getJMSGeoMapObj().createJMSGeoLatLonObj(childTag.getAttribute("lat"),childTag.getAttribute("lon"),ele,time);if(!startPoint){startPoint=point;}pointList.push(point);}break;case"name":title=OpenLayers.Util.getXmlNodeValue(childTag);break;case"desc":description=OpenLayers.Util.getXmlNodeValue(childTag);if(description){description=description.replace(/\n/g,"<br>");}break;default:break;}}if(this.jmsLoggerJMSGeoMapGPXLoad&&this.jmsLoggerJMSGeoMapGPXLoad.isDebug){this.jmsLoggerJMSGeoMapGPXLoad.logDebug("JMSGeoMapGPXLoad.parseXMLDocument add Tour me:"+this+" url:"+this.url+" title:"+title+" start:"+geoPoint+" color:"+color);}this.getJMSGeoMapObj().addTour(null,this.strNameLayer,title,description,startPoint,pointList,{color:color,loadInfoWindowType:JMSGeoMapFeature.TYPE_LOADINFOWINDOW_LOCAL});}}return 0;};JMSGeoMapGPXLoad.prototype.jmsLoggerJMSGeoMapGPXLoad=false;}else{if(JMSGeoMapGPXLoad.prototype.jmsLoggerJMSGeoMapGPXLoad&&JMSGeoMapGPXLoad.prototype.jmsLoggerJMSGeoMapGPXLoad.isDebug){JMSGeoMapGPXLoad.prototype.jmsLoggerJMSGeoMapGPXLoad.logDebug("Class JMSGeoMapGPXLoad already defined");}}JMSGeoMapOsmLocSearchWindow=function(objMap,objName){if(this.FLG_CHECK_CLASSES&&objMap&&!this.checkInstanceOf(objMap,"JMSGeoMap")){this.logError("JMSGeoMapOsmLocSearchWindow(objMap) is no JMSGeoMap: "+objMap);return null;}JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapOsmLocSearchWindow");}this.objMap=objMap;this.objName=objName;};JMSGeoMapOsmLocSearchWindow.prototype=new JMSBase;JMSGeoMapOsmLocSearchWindow.prototype.construcor=JMSGeoMapOsmLocSearchWindow;JMSGeoMapOsmLocSearchWindow.prototype.toString=function(){return"JMSGeoMapOsmLocSearchWindow("+this.objMap+","+this.objName+")";};JMSGeoMapOsmLocSearchWindow.prototype.getJMSGeoMapObj=function(){return this.objJMSGeoMap;};JMSGeoMapOsmLocSearchWindow.prototype.getObjName=function(){return this.objName;};JMSGeoMapOsmLocSearchWindow.prototype.doOsmSearch=function(){this.closeOsmSearchWindow();var title="Suchergebnisse "+"<a href='#' class='osm_search_title' onclick='javascript: "+this.getObjName()+"closeOsmSearchWindow();"+" return false;'>"+"[X Suche schlie�en]</a>";this.openOsmSearchWindow({title:title,content:"Bitte warten"});var formInputName="query";var url="http://nominatim.openstreetmap.org/search?q="+document.getElementById(formInputName).value;url=url+"&format=json&addressdetails=1&json_callback="+this.getObjName()+"parseOsmJSONSearchResult";this.includeOsmJSONRequest("osm_search_include",url);};JMSGeoMapOsmLocSearchWindow.prototype.openOsmSearchWindow=function(options){var html='<div id="osm_search" class="osm_search" style="position:absolute; left:0; top:0; display:none; width: 300px; heigth:50px; z-index:1000;">'+'    <form action="/" id="osm_search_form" method="get" onsubmit="javascript: '+this.getObjName()+'doOsmSearch(); return false;">'+'        Ortsuche: <input id="query" name="q" tabindex="1" type="text" value="" />'+'        <input name="commit" type="submit" value="Los" />'+"        <a href='#' class='osm_search_title' style='float: right; vertical-align: right' onclick='javascript: "+this.getObjName()+"closeOsmSearchWindow();"+" return false;'>"+"[X]</a>"+"    </form>"+"    <br clear=all>"+'    <div id="osm_search_title" class="osm_search_title" style="z-index:1000;"></div>'+"    <br clear=all>"+'    <div id="osm_search_content" class="osm_search_content" style="z-index:1000; height: expression( this.scrollHeight > 300 ? \'300px\' : \'auto\' ); /* sets max-height for IE */ max-height: 333px; /* sets max-height value for all standards-compliant browsers */ overflow:scroll;"></div>'+"    </div>"+'    <div id="osm_search_include"></div>';var idSearchWindow="osm_search";var div=document.getElementById(idSearchWindow);if(!div){var parent=document.getElementById(this.objMap.strHtmlElementId);var div=document.createElement("div");div.innerHTML=html;parent.appendChild(div);}options=options||{};document.getElementById("osm_search_title").innerHTML="";document.getElementById("osm_search_content").innerHTML="";if(options.title){document.getElementById("osm_search_title").innerHTML=options.title;}if(options.content){document.getElementById("osm_search_content").innerHTML=options.content;}document.getElementById("osm_search").style.display="block";};JMSGeoMapOsmLocSearchWindow.prototype.updateOsmSearchWindow=function(content){document.getElementById("osm_search_content").innerHTML=content;};JMSGeoMapOsmLocSearchWindow.prototype.closeOsmSearchWindow=function(){document.getElementById("osm_search").style.display="none";};JMSGeoMapOsmLocSearchWindow.prototype.includeOsmJSONRequest=function(id,url){var parent=document.getElementById(id);var script=document.createElement("script");script.src=url;script.type="text/javascript";parent.appendChild(script);};JMSGeoMapOsmLocSearchWindow.prototype.removeOsmJSONRequest=function(id){var parent=document.getElementById(id);parent.removeChilds();};JMSGeoMapOsmLocSearchWindow.prototype.parseOsmJSONSearchResult=function(results){var content="Keine Ergebnisse gefunden";if(results&&results.length>0){content="<table>";for(var i=0;i<results.length;i++){var location=results[i];content=content+"<tr><td><a href='#' class='osm_search_content' onclick='javascript: "+this.objName+"objMap.setCenter("+"new JMSGeoLatLon("+location.lat+","+location.lon+'), 14, "'+location.display_name+'");'+" return false;'>"+"<img src='"+location.icon+"'>"+location.type+": "+location.display_name+"</a></td></tr>";}content=content+"</table>";this.updateOsmSearchWindow(content);}this.updateOsmSearchWindow(content);};JMSGeoMapDummy4NearBySearchForm=function(pstrHtmlElementId,phshConfig,phshMapConfig){JMSGeoMap.call(this,pstrHtmlElementId,phshConfig,phshMapConfig);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoMapDummy4NearBySearchForm");}};JMSGeoMapDummy4NearBySearchForm.prototype=new JMSGeoMap;JMSGeoMapDummy4NearBySearchForm.prototype.construcor=JMSGeoMapDummy4NearBySearchForm;JMSGeoMapDummy4NearBySearchForm.prototype.destroy=function(){};JMSGeoMapDummy4NearBySearchForm.prototype.setCenter=function(pmpLatLonCenter,pzoom,label){if(this.FLG_CHECK_CLASSES&&pmpLatLonCenter&&!this.checkInstanceOf(pmpLatLonCenter,"JMSGeoLatLon")){this.logError("setCenter(pmpLatLonCenter) is no JMSGeoLatLon: "+pmpLatLonCenter);return null;}if(pmpLatLonCenter){var gpsFormFieldId=this.getConfig()["GPSFORMFIELDID"];if(gpsFormFieldId&&document.getElementById(gpsFormFieldId)){document.getElementById(gpsFormFieldId).value=pmpLatLonCenter.lat+","+pmpLatLonCenter.lon;}var gpsFormLabelId=this.getConfig()["GPSLABELFIELDID"];if(gpsFormLabelId&&document.getElementById(gpsFormLabelId)&&label){document.getElementById(gpsFormLabelId).value=label;}var gpsBlockId=this.getConfig()["GPSBLOCKID"];if(gpsBlockId&&document.getElementById(gpsBlockId)){document.getElementById(gpsBlockId).style.display="block";}var osmFormId="osm_search";if(osmFormId&&document.getElementById(osmFormId)){document.getElementById(osmFormId).style.display="none";}}};if(typeof(JMSGeoProfile)=="undefined"){JMSGeoProfile=function(pstrHtmlElementId,phshConfig,phshMapConfig){JMSGeoMap.call(this,pstrHtmlElementId,phshConfig,phshMapConfig);if(this.FLG_CHECK_CLASSES){this.setClassName("JMSGeoProfile");}this.eventAfterLoad=null;this.objJMSGeoLatLonMin=null;this.objJMSGeoLatLonMax=null;};JMSGeoProfile.prototype=new JMSGeoMap;JMSGeoProfile.prototype.construcor=JMSGeoProfile;JMSGeoProfile.prototype.destroy=function(){};JMSGeoMap.prototype.createJMSGeoLatLonObj=function(pLat,pLon,pEle,pTime){return new JMSGeoLatLonEleTime(pLat,pLon,pEle,pTime);};JMSGeoProfile.prototype.createMapObj=function(){return null;};JMSGeoProfile.prototype.addDefaultControls=function(){return null;};function JMSGeoProfileJMSGeoMapFeatureControls(){return null;}JMSGeoProfileJMSGeoMapFeatureControls.prototype.allowSetVisibility=function(){return null;};JMSGeoProfileJMSGeoMapFeatureControls.prototype.printable=function(){return null;};JMSGeoProfileJMSGeoMapFeatureControls.prototype.selectable=function(){return null;};JMSGeoProfileJMSGeoMapFeatureControls.prototype.initContainer=function(mpMap){return null;};JMSGeoProfileJMSGeoMapFeatureControls.prototype.initialize=function(map){return null;};JMSGeoProfileJMSGeoMapFeatureControls.prototype.getDefaultPosition=function(){return null;};JMSGeoProfile.prototype.addJMSGeoMapFeatureControls=function(){return null;};JMSGeoProfile.prototype.setCenter=function(pmpLatLonCenter,pzoom){if(this.FLG_CHECK_CLASSES&&pmpLatLonCenter&&!this.checkInstanceOf(pmpLatLonCenter,"JMSGeoLatLon")){this.logError("setCenter(pmpLatLonCenter) is no JMSGeoLatLon: "+pmpLatLonCenter);return null;}return null;};JMSGeoProfile.prototype.getCenter=function(){return null;};JMSGeoProfile.prototype.getZoom=function(){return null;};JMSGeoProfile.prototype.removeFeature=function(objFeature,strNameLayer){return null;};JMSGeoProfile.prototype.hideFeature=function(objFeature,strNameLayer){if(objFeature){objFeature.hide();}};JMSGeoProfile.prototype.unhideFeature=function(objFeature,strNameLayer){if(objFeature){objFeature.show();}};JMSGeoProfile.prototype.addFeatureLocation2Map=function(strNameLayer,mpFeatureLocation){if(this.FLG_CHECK_CLASSES&&mpFeatureLocation&&!this.checkInstanceOf(mpFeatureLocation,"JMSGeoMapFeatureLocation")){this.logError("addFeatureLocation2Map(mpFeatureLocation) is no JMSGeoMapFeatureLocation: "+mpFeatureLocation);return null;}return null;};JMSGeoProfile.prototype.addFeatureTour2Map=function(strNameLayer,mpFeatureTour,flgTour){if(this.FLG_CHECK_CLASSES&&mpFeatureTour&&!this.checkInstanceOf(mpFeatureTour,"JMSGeoMapFeatureTour")){this.logError("addFeatureTour2Map(mpFeatureTour) is no JMSGeoMapFeatureTour: "+mpFeatureTour);return null;}var arrCharts=[];var lstFeatureObj=this.hshFeature["TOUR"];for(var id in lstFeatureObj){var mpFeatureTour=lstFeatureObj[id];mpFeatureTour.initMetaData();if(this.jmsLoggerJMSGeoProfile&&this.jmsLoggerJMSGeoProfile.isDebug){this.jmsLoggerJMSGeoProfile.logDebug("JMSGeoProfile.addFeatureTour2Map "+" tourDist:"+mpFeatureTour.metaDist+" tourAsc:"+mpFeatureTour.metaAsc+" tourDesc:"+mpFeatureTour.metaDesc+" objJMSGeoLatLonMin:"+mpFeatureTour.getBoundsJMSGeoLatLon()[0]+" objJMSGeoLatLonMax:"+mpFeatureTour.getBoundsJMSGeoLatLon()[1]);}var myBounds=mpFeatureTour.getBoundsJMSGeoLatLon();if(myBounds){if(!this.objJMSGeoLatLonMin){this.objJMSGeoLatLonMin=myBounds[0];}else{this.objJMSGeoLatLonMin=this.objJMSGeoLatLonMin.getMin(myBounds[0]);}if(!this.objJMSGeoLatLonMax){this.objJMSGeoLatLonMax=myBounds[1];}else{this.objJMSGeoLatLonMax=this.objJMSGeoLatLonMin.getMax(myBounds[1]);}}if(mpFeatureTour.metaLstProfile&&mpFeatureTour.metaLstProfile.length>0){arrCharts.push(mpFeatureTour.metaLstProfile);}}if(arrCharts.length==1){this.printCharts2Map(arrCharts);}else{if(arrCharts.length>1){this.printCharts2Map(arrCharts);}}if(this.eventAfterLoad){this.eventAfterLoad(this);}};JMSGeoProfile.prototype.printCharts2Map=function(arrCharts){if(arrCharts&&(arrCharts.length>0)){if(this.jmsLoggerJMSGeoProfile&&this.jmsLoggerJMSGeoProfile.isDebug){this.jmsLoggerJMSGeoProfile.logDebug("JMSGeoProfile.printCharts2Map arrCharts="+arrCharts);}$.jqplot(this.strHtmlElementId,arrCharts,{series:[{showMarker:false},{showMarker:false},{showMarker:false}],axesDefaults:{pad:0,labelRenderer:$.jqplot.CanvasAxisLabelRenderer},axes:{xaxis:{pad:0},yaxis:{}}});}};JMSGeoProfile.prototype.addFeatureImage2Map=function(strNameLayer,mpFeatureImage){if(this.FLG_CHECK_CLASSES&&mpFeatureImage&&!this.checkInstanceOf(mpFeatureImage,"JMSGeoMapFeatureImage")){this.logError("addFeatureImage2Map(mpFeatureImage) is no JMSGeoMapFeatureImage: "+mpFeatureImage);return null;}return null;};JMSGeoProfile.prototype.setViewRectangle=function(strNameLayer,zoomLat,zoomLon){return null;};JMSGeoProfile.prototype.openInfoWindow=function(pos,name,content){return null;};JMSGeoProfile.prototype.openStatusWindow=function(name,content){return null;};JMSGeoProfile.prototype.closeStatusWindow=function(popup){return null;};JMSGeoProfile.prototype.addDefaultLayer=function(){return null;};JMSGeoProfile.prototype.registerMapEvent=function(event,functionRef){if(event=="afterLoad"){this.eventAfterLoad=functionRef;}return null;};JMSGeoProfile.prototype.registerJMSGeoMapFeatureEvent=function(mpFeature,event,functionRef){if(this.FLG_CHECK_CLASSES&&mpFeature&&!this.checkInstanceOf(mpFeature,"JMSGeoMapFeature")){this.logError("registerJMSGeoMapFeatureEvent(mpFeature) is no JMSGeoMapFeature: "+mpFeature);return null;}return null;};JMSGeoProfile.prototype.jmsLoggerJMSGeoProfile=false;}else{if(JMSGeoProfile.prototype.jmsLoggerJMSGeoProfile&&JMSGeoProfile.prototype.jmsLoggerJMSGeoProfile.isDebug){JMSGeoProfile.prototype.jmsLoggerJMSGeoProfile.logDebug("Class JMSGeoProfile already defined");}}if(typeof(JMATPageLayout)=="undefined"){JMATPageLayout=function(){JMSLayout.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMATPageLayout");}};JMATPageLayout.prototype=new JMSLayout;JMATPageLayout.prototype.classNamesLinkLoadOnBigWindowDetailFrame=["a-flg-bigwindow","a-list-tour","a-list-kategorie","a-list-image","a-tour-katlink","a-list-boxname-kategorie-shortlong","a-list-boxname-tour-shortlong","a-list-detail-tourlinks","a-tagcloud-tour","a-tagcloud-tour-aktiv","a-tagcloud-kategorie","a-tagcloud-kategorie-aktiv","a-locdesc","a-location-desclink","a-list-image-big","a-searchintro-themen","a-searchintro-region","a-searchintro-aktionen"];JMATPageLayout.prototype.classNamesLinkLoadMsg=["a-menue-nav-norm","a-menue-nav-aktiv","a-menue-top-norm","a-favorites-re-norm","a-aktion","a-aktion-aktiv","a-aktion-themennav","a-themen-norm","a-navigator-norm","a-navigator-aktiv","flg-display-loading","flg-showloading"];JMATPageLayout.prototype.toString=function(){return"JMATPageLayout();";};JMATPageLayout.prototype.isBigWindowDetailFrameOn=function(){if(this.isBigWindowDetailFrameTechRequirementsOK()&&this.isBigWindowDetailFrameRequested()){return true;}return false;};JMATPageLayout.prototype.isBigWindowDetailFrameTechRequirementsOK=function(){if(window.name!="bigwindowdetailframe"&&window.innerWidth>1450&&typeof("flgDetailFrameAllowed"!="undefined"&&flgDetailFrameAllowed==true)){return true;}return false;};JMATPageLayout.prototype.isBigWindowDetailFrameRequested=function(){var flgRequested=false;try{var coockieValue=this.getJMSServiceObj().readCookie("flgShowBigWindowDetailFrame");if(coockieValue&&((coockieValue=="today")||(coockieValue=="always"))){flgRequested=true;}}catch(ex){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.isBigWindowDetailFrameRequested error:"+ex);}}if(flgRequested){return true;}return false;};JMATPageLayout.prototype.setBigWindowDetailFrameRequested=function(value){try{this.getJMSServiceObj().writeCookie("flgShowBigWindowDetailFrame",value,null);var hintName=null;if(this.isBigWindowDetailFrameOn()){this.initPageLayoutStylesForUseOfBigWindowDetailFrame();this.openLinkAsBigWindowDetailFrame("info-steuerung.php");}else{this.deactivatePageLayoutStylesForUseOfBigWindowDetailFrame();}}catch(ex){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.setBigWindowDetailFrameRequested error:"+ex);}}};JMATPageLayout.prototype.initPageLayoutStep1BeforLoad=function(){if(window.name=="bigwindowdetailframe"){this.showAsBigWindowDetailFrame();}else{if(this.isBigWindowDetailFrameOn()){this.initPageLayoutStylesForUseOfBigWindowDetailFrame();}}};JMATPageLayout.prototype.initPageLayoutStep2AfterLoad=function(){if(this.isBigWindowDetailFrameOn()){this.openLinkAsBigWindowDetailFrame("info-steuerung.php");}else{if(this.isBigWindowDetailFrameTechRequirementsOK()){this.showMsgForUseOfBigWindowDetailFrame();}}this.activateJSElements();this.activateGeoLocationElements();this.activateSpeechRecognitionElements();this.activateDeviceElements();this.setUnloadEvents();};JMATPageLayout.prototype.showMsgForUseOfBigWindowDetailFrame=function(){try{var loadingHtml='<div class="box fx-bg-pageaction box-hint4bigwindowdetailframe" id="box-hint4bigwindowdetailframe"><span class="box-hint4bigwindowdetailframe-msg">Mensch hier ist ja noch viel Platz :-)<br>Wollen wir den nicht daf�r nutzen die Listeneintr�ge hier anzuzeigen??<br>Klicke einfach <a href="#" onclick="javascript: jMATService.getPageLayoutService().setBigWindowDetailFrameRequested(\'always\'); return false;">hier um die gro�e Seite zu aktivieren</a></span></div>';this.getJMSServiceObj().appendHtml(loadingHtml,"txt-content");}catch(e){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.showMsgForUseOfBigWindowDetailFrame cant load Msg:"+e);}}};JMATPageLayout.prototype.initPageLayoutStylesForUseOfBigWindowDetailFrame=function(){var styles=".page-div-center { text-align: left; } .blockSupport { display: none;} .box-hint4bigwindowdetailframe { display: none;} .box-hint4deaktivatebigwindowdetailframe { display: block;} .bigwindowdetailframe {display: block;} .menueNavServiceLeft {display: block;}";var classNames=this.classNamesLinkLoadOnBigWindowDetailFrame;for(var j=0;j<classNames.length;j++){var className=classNames[j];styles+=" ."+className+"{ color: #75077F;}";}this.getJMSServiceObj().insertStyleBeforeScript(styles);};JMATPageLayout.prototype.deactivatePageLayoutStylesForUseOfBigWindowDetailFrame=function(){var styles=".page-div-center { text-align: center; align: center;} .blockSupport { display: block; } .box-hint4bigwindowdetailframe { display: block;} .box-hint4deaktivatebigwindowdetailframe { display: none;} .bigwindowdetailframe {display: none;} .menueNavServiceLeft {display: none;}";var classNames=this.classNamesLinkLoadOnBigWindowDetailFrame;for(var j=0;j<classNames.length;j++){var className=classNames[j];styles+=" ."+className+"{ color: #75077F;}";}this.getJMSServiceObj().insertStyleBeforeScript(styles);};JMATPageLayout.prototype.showAsBigWindowDetailFrame=function(){var styles=".blockMenue {display: none} .blockSupport {display: none} .box-toc {display: none} .pageContent { width: 600px;} .menueTop {display: none;}";this.getJMSServiceObj().insertStyleBeforeScript(styles);};JMATPageLayout.prototype.openLinkAsBigWindowDetailFrame=function(origUrl){var url=origUrl;var iframe=document.getElementById("bigwindowdetailframe");if(!iframe){var html="<div class='box box-hint4deaktivatebigwindowdetailframe' id='box-hint4deaktivatebigwindowdetailframe'><a href=\"#\" onclick=\"javascript: jMATService.getPageLayoutService().setBigWindowDetailFrameRequested('never'); return false;\">[Detailfenster deaktivieren]</a></div><iframe id='bigwindowdetailframe' name='bigwindowdetailframe' class='bigwindowdetailframe' width='600px' height='800px' src='"+url+"'></iframe>";jMATService.getJMSServiceObj().appendHtml(html,"pageContent");if(jMATService.jmsLoggerJMATPageLayout&&jMATService.jmsLoggerJMATPageLayout.isDebug){jMATService.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout. linkOnSubmitList Iframe createted:"+url);}this.initPageLayoutStylesForUseOfBigWindowDetailFrame();}else{iframe.src=url;if(jMATService.jmsLoggerJMATPageLayout&&jMATService.jmsLoggerJMATPageLayout.isDebug){jMATService.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout. linkOnSubmitList Iframe upated:"+url);}}var iframe=document.getElementById("bigwindowdetailframe");if(iframe){iframe.height=(window.innerHeight-iframe.style.top-20);iframe.style.height=(window.innerHeight-iframe.style.top-20)+"px";}};JMATPageLayout.prototype.activateJSElements=function(){var styles=".display-if-js-inline { display: inline; } .display-if-js-block { display: block;} ";this.getJMSServiceObj().insertStyleBeforeScript(styles);this.getJMSServiceObj().appendStyleAtEnd(styles);if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateJSElements "+styles);}};JMATPageLayout.prototype.activateGeoLocationElements=function(){if(this.getJMSServiceObj().isGeoLocationFromBrowserSupported()){var styles=".display-if-jsgeo-inline { display: inline; } .display-if-jsgeo-block { display: block;} ";this.getJMSServiceObj().insertStyleBeforeScript(styles);this.getJMSServiceObj().appendStyleAtEnd(styles);if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateGeoLocationElements "+styles);}}};JMATPageLayout.prototype.activateSpeechRecognitionElements=function(){if(this.getJMSServiceObj().isWebkitSpeechRecognitionFromBrowserSupported()){var styles=".display-if-jsspeechrecognition-inline { display: inline; } .display-if-jsspeechrecognition-block { display: block;} ";this.getJMSServiceObj().insertStyleBeforeScript(styles);this.getJMSServiceObj().appendStyleAtEnd(styles);if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateSpeechRecognitionElements "+styles);}}};JMATPageLayout.prototype.isMobileVersion=function(){var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("/mobile/")>0){return true;}return false;};JMATPageLayout.prototype.activateDeviceElements=function(){};JMATPageLayout.prototype.setUnloadEvents=function(){var myOnSubmit=function(){try{jMATService.OnUnload();}catch(ex){}return true;};if(typeof(window.onunload)!="function"){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateUnloadEvents set window.OnUnload() with jMATService.OnUnload()");}window.onunload=myOnSubmit;}var forms=document.getElementsByTagName("form");for(var j=0;j<forms.length;j++){var form=forms[j];if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateUnloadEvents check form");}if(typeof(form.onsubmit)!="function"){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isDebug){this.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout.activateUnloadEvents set form.onsubmit() with jMATService.OnUnload()");}form.onsubmit=myOnSubmit;}}var linkOnSubmit=function(){try{if(!this.target){jMATService.OnUnload();}}catch(ex){if(jMATService.jmsLoggerJMATService&&jMATService.jmsLoggerJMATService.isError){jMATService.jmsLoggerJMATService.logError("JMATPageLayout. linkOnSubmit OnUnload error:"+ex);}}return true;};var classNames=this.classNamesLinkLoadMsg;this.getJMSServiceObj().addLinkOnClickEvent(classNames,linkOnSubmit,false);var linkOnSubmitList=function(){try{if(jMATService.getPageLayoutService().isBigWindowDetailFrameOn()){jMATService.getPageLayoutService().openLinkAsBigWindowDetailFrame(this);return false;}if(this.onclickold){return this.onclickold();}else{if(!this.target){jMATService.OnUnload();}}}catch(ex){if(jMATService.jmsLoggerJMATService&&jMATService.jmsLoggerJMATService.isError){jMATService.jmsLoggerJMATService.logError("JMATPageLayout. linkOnSubmit OnUnload error:"+ex);}}return true;};var classNames=this.classNamesLinkLoadOnBigWindowDetailFrame;this.getJMSServiceObj().addLinkOnClickEvent(classNames,linkOnSubmitList,true);};JMATPageLayout.prototype.showAsBookVersion=function(){var styles=".box-themennav {display: none;} .box-searchform {display: none;} .innerline-tour-kategorien { display: none;} .box-todonext {display: none;} .box-toc {display: none;} ";var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("ASBOOKVERSION=2")>0){styles=styles+" .txt-copyrights {display: none;} .blockQRCode {display: none;}";}this.getJMSServiceObj().appendStyle(styles,"pageContent");};JMATPageLayout.prototype.showLoadingMsg=function(){try{var loadingHtml='<div class="box fx-bg-change-content box-loading"><img alt="L&auml;dt.." src="images/loading.gif" class="box-loading-gif"><span class="box-loading-msg">Suche l�uft. Bitte haben Sie einen Augenblick Geduld bis die Seite geladen ist.</span></div>';this.getJMSServiceObj().appendHtml(loadingHtml,"txt-content");}catch(e){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.showLoadingMsg cant load LoadingMsg:"+e);}}};JMATPageLayout.prototype.showTOC=function(){try{var tocList=document.getElementsByClassName("add2toc-h1");if(tocList.length>0){var tocHtml="<br clear=all><div class='box box-toc fx-bg-pageaction ' id='boxtoc'><div class='fx-bg-button-sitenav box-toc-ue'>Inhalt</div><ul class='toclist' id='toclist'>";var flgEntry=false;for(var j=0;j<tocList.length;j++){var element=tocList[j];var label=element.getAttribute("toclabel");var id=element.id;if(id&&label){tocHtml=tocHtml+"\n<li><a href='#"+id+"' class='a-toc-entry'>"+label+"</a></li>\n";flgEntry=true;}}tocHtml=tocHtml+"\n<br><li><a href='#' "+" onclick=\"javascript:showAsPrintVersion(); window.print(); return false;\" class='a-toc-entry'>"+"Drucken</a></li>\n";tocHtml=tocHtml+"\n<li><a href='#' "+" onclick=\"javascript:jMATService.getPageLayoutService().showHideMenuHistorie(false); return false;\" class='a-toc-entry'>"+"Zur&uuml;ck</a></li>\n";if(this.flgUserJMSDiashow){var serviceDiashow=this.getServiceObj("JMSDiashowService");if(serviceDiashow&&serviceDiashow.hasDiashowImages("dia_gesamt")){tocHtml=tocHtml+"\n<br><li><a href='#' "+" onclick=\"javascript:startDiashow('dia_gesamt'); return false;\" class='a-toc-entry'>"+"Diashow</a></li>\n";}}var toggleList=document.getElementsByClassName("blockToggler");if(toggleList.length>0){tocHtml=tocHtml+"\n<li><a href='#' class='a-toc-entry' onclick='javascript:jMATService.getPageLayoutService().doAllBlockToggler(false); return false;'>"+"Alles Schlie&szlig;en</a></li>\n"+"\n<li><a href='#' class='a-toc-entry' onclick='javascript:jMATService.getPageLayoutService().doAllBlockToggler(true); return false;'>"+"Alles Zeigen</a></li>\n";}tocHtml=tocHtml+"</ul></div>";if(flgEntry){this.getJMSServiceObj().appendHtml(tocHtml,"blockSupport");}}}catch(e){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.showTOC cant LOad TOC:"+e);}}};JMATPageLayout.prototype.showQRCode=function(){var myUrl=this.getJMSServiceObj().getMyUrl();try{if(myGeneratedUrl){myUrl=myGeneratedUrl;}}catch(e){}myUrl=myUrl.replace(/localhost\/michas\//,"www.michas-ausflugstipps.de/");myUrl=myUrl.replace(/\/michas\//,"/");myUrl=myUrl.replace(/&amp;/g,"&");try{var tag=document.createElement("script");tag.src="jsres/jsqr.js";tag.onload=function(){jMATService.getJMSServiceObj().generateQR(myUrl,"qrcode");};var firstScriptTag=document.getElementsByTagName("script")[0];firstScriptTag.parentNode.insertBefore(tag,firstScriptTag);}catch(e){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.showQR cant Load QR:"+e);}}};JMATPageLayout.prototype.showAsPrintVersion=function(){var divBlock=document.getElementById("blockMenue");if(divBlock){divBlock.style.display="none";}divBlock=document.getElementById("blockSupport");if(divBlock){divBlock.style.display="none";}divBlock=document.getElementById("pageContent");if(divBlock){divBlock.style.width="600px";}var styles=".box-todonext {display: none;} .box-toc {display: none;} .box-hint4bigwindowdetailframe { display: none;} .box-hint4deaktivatebigwindowdetailframe { display: none;} .bigwindowdetailframe {display: none;} .menueFooter {display: none;} .hide-if-printversion { display: none;} .hide-if-printversion-inline { display: none;} .hide-if-printversion-block { display: none;} ";this.getJMSServiceObj().appendStyleAtEnd(styles);this.showQRCode();};JMATPageLayout.prototype.optimizeTour4print=function(){var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("OPTIMIZEPRINT=A4")>0){this.moveBlockOnPage("boxline-line-tour-keywords","box-detail-tourdesc-prinoptimized","tourMap");this.moveBlockOnPage("boxline-line-tour-timeline","box-detail-tourdesc-prinoptimized","tourMap");this.moveMapOnPage("boxline-line-tour-desc","box-detail-tourdesc-prinoptimized","boxline-line-tourdesc-prinoptimized","tourMap");this.insertPageBreakBlockOnPage("box-detail-tourdesc-prinoptimized",100,15);this.insertPageBreakBlockOnPage("box-mapprofile",150,15);this.insertPageBreakBlockOnPage("box-list-tourimages",300,15);this.insertPageBreakBlockOnPage("box-list-toursametouren",100,15);}};JMATPageLayout.prototype.optimizeKategorie4print=function(){var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("OPTIMIZEPRINT=A4")>0){if(((myUrl.search("SHOWONLYBESTIMAGES=")>0)&&document.getElementById("box-list-katimages"))||myUrl.search("SHOWONLYBESTIMAGES=")>1){divBlock=document.getElementById("boxblock-data-kategorieimages-all");if(divBlock){divBlock.style.display="none";}divBlock=document.getElementById("boxline-ue2-kategorieimages-all");if(divBlock){divBlock.style.display="none";}}}this.insertPageBreakBlockOnPage("boxblock-data-kategorietouren",35,15);this.insertPageBreakBlockOnPage("box-list-katimages",300,15);this.insertPageBreakBlockOnPage("box-mapprofile",150,15);this.insertPageBreakBlockOnPage("box-list-katimages2",150,15);};JMATPageLayout.prototype.optimizeLocation4print=function(){var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("OPTIMIZEPRINT=A4")>0){this.moveBlockOnPage("boxline-line-location-tagcloud","box-detail-location-desc-prinoptimized","locmap");this.moveBlockOnPage("boxline-line-location-timeline","box-detail-location-desc-prinoptimized","locmap");this.insertPageBreakBlockOnPage("box-detail-location-desc-prinoptimized",100,15);this.insertPageBreakBlockOnPage("box-detail-location-desc-prinoptimized",100,15);this.insertPageBreakBlockOnPage("box-list-locationkategorien",200,15);this.insertPageBreakBlockOnPage("box-list-sublocationlist",100,15);this.insertPageBreakBlockOnPage("box-list-locationinfos1",100,15);this.insertPageBreakBlockOnPage("box-list-locationinfos2",100,15);this.insertPageBreakBlockOnPage("box-list-locationkategorien-umgebung",200,15);this.insertPageBreakBlockOnPage("box-list-locationtouren",160,30);this.insertPageBreakBlockOnPage("box-list-locationtouren-umgebung",160,30);this.insertPageBreakBlockOnPage("box-list-locationimages",200,30);}};JMATPageLayout.prototype.addStyleIfKeywordsFound=function(parentId,haystack,lstKeywords,newStyle){var flgFound=false;if(haystack&&lstKeywords&&newStyle){flgFound=this.getJMSServiceObj().doActionIfNeedlesFound(haystack,lstKeywords,function(keyword){jMATService.getJMSServiceObj().insertStyleBeforeScript(newStyle);});}return flgFound;};JMATPageLayout.prototype.showHideMenuHistorie=function(forceHide){var blockMenu=document.getElementById("menueHistorie");if(blockMenu){var curDisplay=blockMenu.style.display;if(curDisplay=="block"||forceHide){blockMenu.style.display="none";}else{blockMenu.style.display="block";}}};JMATPageLayout.prototype.showHideMenuNav=function(forceHide){var blockMenu=document.getElementById("blockMenue");var blockContent=document.getElementById("blockContent");var blockMenuTop=document.getElementById("menueTop");if(blockMenu&&blockContent&&blockMenuTop){var curDisplay=blockMenu.style.display;if(curDisplay=="block"||forceHide){blockMenu.style.display="none";}else{blockMenu.style.left=blockContent.offsetLeft+13;blockMenu.style.top=blockMenuTop.offsetTop+blockMenuTop.offsetHeight;blockMenu.style.display="block";}}};JMATPageLayout.prototype.showHideMenuSupport=function(forceHide){var blockMenu=document.getElementById("blockSupport");var blockContent=document.getElementById("blockContent");var blockMenuTop=document.getElementById("menueTop");if(blockMenu&&blockContent&&blockMenuTop){var curDisplay=blockMenu.style.display;if(curDisplay=="block"||forceHide){blockMenu.style.display="none";}else{blockMenu.style.display="block";blockMenu.style.left=blockContent.offsetLeft+blockContent.offsetWidth-(blockMenu.offsetWidth+13);blockMenu.style.top=blockMenuTop.offsetTop+blockMenuTop.offsetHeight;}}};JMATPageLayout.prototype.showHideMenuFavorites=function(forceHide){var blockMenu=document.getElementById("menueTopFavorites");if(blockMenu){var curDisplay=blockMenu.style.display;var favLink=document.getElementById("liMenueTopFavorites");if(curDisplay=="block"||forceHide){blockMenu.style.display="none";}else{blockMenu.style.display="block";}}};JMATPageLayout.prototype.createBlockTogglerHtml=function(togglerBaseId,toggleId,htmlOn,htmlOff,addStyleOn,addStyleOff){if(!toggleId||!togglerBaseId){return null;}toggleElement=document.getElementById(toggleId);if(!toggleElement){return null;}var html='<div class="blockToggler " id="blockToggler4'+toggleId+'" toggleId="'+toggleId+'" togglerBaseId="'+togglerBaseId+'">';html+='<a href="#" onclick="javascript: jMATService.getLayoutService().toggleBlock(\''+togglerBaseId+"', '"+toggleId+"', function () { new ToggleEffect('"+toggleId+'\').doEffect();}); return false;" class="blockToggler blockTogglerOn '+addStyleOn+'" id="'+togglerBaseId+'_On">';html+=htmlOn+"</a>";html+='<a href="#" onclick="javascript: jMATService.getLayoutService().toggleBlock(\''+togglerBaseId+"', '"+toggleId+"', function () { new ToggleEffect('"+toggleId+'\').doEffect();}); return false;" class="blockToggler blockTogglerOff '+addStyleOff+'" style="display: none;" id="'+togglerBaseId+'_Off">';html+=htmlOff+"</a>";html+="</div>";return html;};JMATPageLayout.prototype.appendBlockToggler=function(parentId,toggleId){var html=jMATService.getPageLayoutService().createBlockTogglerHtml(toggleId,toggleId,"<img src='/images/icon-up.gif' class='icon-blocktoggler icon-blocktoggleron'>","<img src='/images/icon-down.gif' class='icon-blocktoggler icon-blocktogglerof'>","","");jMATService.getJMSServiceObj().appendHtml(html,parentId,"blockToggler");};JMATPageLayout.prototype.doAllBlockToggler=function(flgShow){try{var toggleList=document.getElementsByClassName("blockToggler");if(toggleList.length>0){for(var j=0;j<toggleList.length;j++){var element=toggleList[j];var toggleId=element.getAttribute("toggleId");var togglerBaseId=element.getAttribute("togglerBaseId");var effect=function(){new ToggleEffect(toggleId).doEffect();};if(flgShow){jMATService.getLayoutService().togglerBlockShow(togglerBaseId,toggleId,effect);}else{jMATService.getLayoutService().togglerBlockHide(togglerBaseId,toggleId,effect);}}}}catch(e){if(this.jmsLoggerJMATPageLayout&&this.jmsLoggerJMATPageLayout.isError){this.jmsLoggerJMATPageLayout.logError("JMATPageLayout.showAllBlockToggler cant Load:"+e);}}};JMATPageLayout.prototype.createFormrowToggler=function(togglerBaseId,toggleClassName,htmlOn,htmlOff,addStyleOn,addStyleOff){if(!togglerBaseId){return null;}var html='<a href="#" onclick="javascript: jMATService.getPageLayoutService().toggleFormrows(\''+togglerBaseId+"', '"+toggleClassName+'\', false); return false;" class="formrowToggler formrowTogglerOn '+addStyleOn+'" id="'+togglerBaseId+'_On">';html+=htmlOn+"</a>";html+='<a href="#" onclick="javascript: jMATService.getPageLayoutService().toggleFormrows(\''+togglerBaseId+"', '"+toggleClassName+'\', true); return false;" class="formrowToggler formrowTogglerOff '+addStyleOff+'" style="display: none;" id="'+togglerBaseId+'_Off">';html+=htmlOff+"</a>";return html;};JMATPageLayout.prototype.toggleFormrows=function(togglerBaseId,toggleClassName,flgVisible){if(!togglerBaseId){return null;}togglerElementOn=document.getElementById(togglerBaseId+"_On");togglerElementOff=document.getElementById(togglerBaseId+"_Off");togglerOnDisplay="none";togglerOffDisplay="none";if(flgVisible){togglerOnDisplay="inline";togglerOffDisplay="none";}else{togglerOnDisplay="none";togglerOffDisplay="inline";}if(togglerElementOn){togglerElementOn.style.display=togglerOnDisplay;}if(togglerElementOff){togglerElementOff.style.display=togglerOffDisplay;}jMATService.getLayoutService().showHideAllInputRows(toggleClassName,flgVisible);};JMATPageLayout.prototype.hideFormrowsIfTogglerOff=function(togglerBaseId,toggleClassName){if(!togglerBaseId){return null;}togglerElementOff=document.getElementById(togglerBaseId+"_Off");if((togglerElementOff&&togglerElementOff.style.display!="none")||(toggleClassName=="HIDE_EVERYTIME")){this.showHideAllInputRows(toggleClassName,false);}};JMATPageLayout.prototype.appendFormrowToggler=function(parentId,togglerBaseId,toggleClassName,label){var html=jMATService.getPageLayoutService().createFormrowToggler(togglerBaseId,toggleClassName,label+"<img src='/images/icon-up.gif' class='icon-formrowtoggler icon-formrowtoggleron'>",label+"<img src='/images/icon-down.gif' class='icon-formrowtoggler icon-formrowtogglerof'>","","");jMATService.getJMSServiceObj().appendHtml(html,parentId,"formrowToggler");};JMATPageLayout.prototype.createFormrowResetterHtml=function(formrowBaseId,htmlReset,className){if(!formrowBaseId){return null;}formrowElement=document.getElementById(formrowBaseId);if(!formrowElement){return null;}var html='<div class="blockFormrowReset " id="blockFormRowReset4'+formrowBaseId+'">';html+='<a href="#" onclick="javascript: jMATService.getPageLayoutService().resetFormrow(\''+formrowBaseId+"'); jMATService.getPageLayoutService().hideFormrowsIfTogglerOff('"+className+"', '"+className+'\'); return false;" class="blockFormrowReset ">';html+=htmlReset+"</a>";html+="</div>";return html;};JMATPageLayout.prototype.appendFormrowResetter=function(formrowBaseId,className){var html=jMATService.getPageLayoutService().createFormrowResetterHtml(formrowBaseId,"<img src='/images/icon-reset.gif' class='icon-formrowreset' id='iconFormRowReset4"+formrowBaseId+"'>",className);jMATService.getJMSServiceObj().appendHtml(html,formrowBaseId+"_divinput","formrowResetter");eleInputRow=document.getElementById(formrowBaseId);if(eleInputRow){var lstInputIds=jMATService.getPageLayoutService().getInputIdsFromInputRow(eleInputRow);if(!lstInputIds||lstInputIds.length<=0){return false;}jMATService.getPageLayoutService().setFormRowRessetterIcon4State(formrowBaseId);for(var i=0;i<lstInputIds.length;++i){var eleInputId=lstInputIds[i];var eleInput=document.getElementById(eleInputId);if(eleInput&&!eleInput.getAttribute("onchangefixed")){var myOnChange=function(){try{jMATService.getPageLayoutService().setFormRowRessetterIcon4State(""+formrowBaseId);}catch(ex){}return true;};eleInput.onchange=myOnChange;}}}};JMATPageLayout.prototype.setFormRowRessetterIcon4State=function(formrowBaseId){if(!formrowBaseId){return null;}resetIcon=document.getElementById("iconFormRowReset4"+formrowBaseId);resetElement=document.getElementById(formrowBaseId);if(resetElement&&resetIcon){state=this.getState4InputRow(resetElement);if(state){resetIcon.src="/images/icon-reset.gif";}else{resetIcon.src="/images/icon-reset-off.gif";}}};JMATPageLayout.prototype.appendFormrowResetter4ClassName=function(className){var lstInputRows=this.getInputRows(className);if(!lstInputRows||lstInputRows.length<=0){return null;}for(var i=0;i<lstInputRows.length;++i){var eleInputRow=lstInputRows[i];this.appendFormrowResetter(eleInputRow.id,className);}};JMATPageLayout.prototype.resetFormrow=function(formrowBaseId){if(!formrowBaseId){return null;}resetElement=document.getElementById(formrowBaseId);if(resetElement){this.resetInputRow(resetElement);}this.setFormRowRessetterIcon4State(formrowBaseId);};JMATPageLayout.prototype.createNumberRangeSliderHtml=function(formrowBaseId,newSliderId,className){if(!formrowBaseId||!newSliderId){return null;}formrowElement=document.getElementById(formrowBaseId);if(!formrowElement){return null;}var html='<div class="blockRangeSlider blockNumberRangeSlider display-if-js-inline" id="blockNumberRangeSlider'+newSliderId+'">';html+="<div id='"+newSliderId+"' class='rangeSlider numberRangeSlider "+className+"'></div>";html+="</div>";return html;};JMATPageLayout.prototype.appendNumberRangeSlider=function(formrowBaseId,idElemMin,idElemMax,idSlider,min,max,className){var html=jMATService.getPageLayoutService().createNumberRangeSliderHtml(formrowBaseId,idSlider,className);jMATService.getJMSServiceObj().appendHtml(html,formrowBaseId,"divblockRangeSlider divblockNumberRangeSlider");jMATService.getPageLayoutService().showNumberRangeSlider(idElemMin,idElemMax,idSlider,min,max,className);};JMATPageLayout.prototype.appendNumberRangeSlider_Short=function(elemBaseId,min,max,className){var baseId="formrow_";var minId=elemBaseId+"-GE";formrowElement=document.getElementById(minId);if(!formrowElement){minId=null;}else{baseId=baseId+minId+"_";}var maxId=elemBaseId+"-LE";formrowElement=document.getElementById(maxId);if(!formrowElement){maxId=null;}else{baseId=baseId+maxId+"_";}jMATService.getPageLayoutService().appendNumberRangeSlider(baseId+"divinput",minId,maxId,elemBaseId+"-slider",min,max,className);};JMATPageLayout.prototype.createSelectRangeSliderHtml=function(formrowBaseId,newSliderId,className){if(!formrowBaseId||!newSliderId){return null;}formrowElement=document.getElementById(formrowBaseId);if(!formrowElement){return null;}var html='<div class="blockRangeSlider blockSelectRangeSlider display-if-js-inline" id="blockSelectRangeSlider'+newSliderId+'">';html+="<div id='"+newSliderId+"' class='rangeSlider selectRangeSlider "+className+"'></div>";html+="</div>";return html;};JMATPageLayout.prototype.appendSelectRangeSlider=function(formrowBaseId,idElemMin,idElemMax,idSlider,defaultValue,className){var html=jMATService.getPageLayoutService().createSelectRangeSliderHtml(formrowBaseId,idSlider,className);jMATService.getJMSServiceObj().appendHtml(html,formrowBaseId,"divblockRangeSlider divblockSelectRangeSlider");jMATService.getPageLayoutService().showSelectRangeSlider(idElemMin,idElemMax,idSlider,defaultValue);};JMATPageLayout.prototype.appendSelectRangeSlider_Short=function(elemBaseId,defaultValue,className){var baseId="formrow_";var minId=elemBaseId+"-GE";formrowElement=document.getElementById(minId);if(!formrowElement){minId=null;}else{baseId=baseId+minId+"_";}var maxId=elemBaseId+"-LE";formrowElement=document.getElementById(maxId);if(!formrowElement){maxId=null;}else{baseId=baseId+maxId+"_";}jMATService.getPageLayoutService().appendSelectRangeSlider(baseId+"divinput",minId,maxId,elemBaseId+"-slider",defaultValue,className);};JMATPageLayout.prototype.doBasketFavoritesAction=function(module,id){if(!module||!id){return null;}var iconId="favorite-icon-"+module+"-"+id;var status="favorite-off";var action="ADD";iconElement=document.getElementById(iconId);if(!iconElement){return false;}status=iconElement.getAttribute("favoritestate");if(JMATPageLayout.prototype.jmsLoggerJMATPageLayout&&JMATPageLayout.prototype.jmsLoggerJMATPageLayout.isDebug){JMATPageLayout.prototype.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout doBasketFavoritesAction: module="+module+", id="+id+" state="+status);}if(status=="favorite-on"){status="favorite-off";action="DELETE";}var url="./ajaxaction_dobasketfavorites.php?ACTION="+action+"&MODULE="+module+"&ID="+id;if(JMATPageLayout.prototype.jmsLoggerJMATPageLayout&&JMATPageLayout.prototype.jmsLoggerJMATPageLayout.isDebug){JMATPageLayout.prototype.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout doBasketFavoritesAction: call URL="+url);}var parent=document.getElementsByTagName("script")[0];var script=document.createElement("script");script.src=url;script.type="text/javascript";parent.appendChild(script);iconElement.setAttribute("favoritestate",status);};JMATPageLayout.prototype.doBasketFavoritesActionCallback=function(module,id,action,resultCode,resultMsg,countModule,countAll){if(JMATPageLayout.prototype.jmsLoggerJMATPageLayout&&JMATPageLayout.prototype.jmsLoggerJMATPageLayout.isDebug){JMATPageLayout.prototype.jmsLoggerJMATPageLayout.logDebug("JMATPageLayout doBasketFavoritesActionCallback: "+"module="+module+", id="+id+", action="+action+", resultCode="+resultCode+", resultMsg="+resultMsg+", countModule="+countModule+", countAll="+countAll);}if(!module||!id){return null;}var iconId="favorite-icon-"+module+"-"+id;var status="favorite-off";var title="Zur Merkliste hinzuf�gen.";var label="Merken";var iconElement=document.getElementById(iconId);if(!iconElement){return false;}if(action=="ADD"){status="favorite-on";title="Eintrag ist vorgemerkt. Aus Merkliste entfernen?";label="Vorgemerkt";}iconElement.setAttribute("favoritestate",status);iconElement.src="images/icon-"+status+".gif";iconElement.desc=title;iconElement.title=title;iconElement.alt=title;var iconId="favorite-textwithicon-icon-"+module+"-"+id;iconElement=document.getElementById(iconId);if(iconElement){iconElement.setAttribute("favoritestate",status);iconElement.src="images/icon-"+status+".gif";iconElement.desc=title;iconElement.title=title;iconElement.alt=title;}var textId="favorite-textwithicon-text-"+module+"-"+id;var textElement=document.getElementById(textId);if(textElement){textElement.innerHTML=label;}var footerLinkElement=document.getElementById("menueFooterMasterLinkFavoriteBasket");if(footerLinkElement){if(countAll>0){footerLinkElement.style.display="inline";}else{footerLinkElement.style.display="none";}}};JMATPageLayout.prototype.jmsLoggerJMATPageLayout=false;}else{if(JMATPageLayout.prototype.jmsLoggerJMATPageLayout&&JMATPageLayout.prototype.jmsLoggerJMATPageLayout.isDebug){JMATPageLayout.prototype.jmsLoggerJMATPageLayout.logDebug("Class JMATPageLayout already defined");}}if(typeof(ToggleEffect)=="undefined"){var toggleObjs=new Array();ToggleEffect=function(elementName){this.timerlen=5;this.slideAniLen=500;this.element=document.getElementById(elementName);this.elementName=elementName;this.timerID;this.endLength=0;this.moving=false;this.dir="up";this.startTime;if(typeof toggleObjs[elementName]=="undefined"){toggleObjs[elementName]=this;}};ToggleEffect.prototype=Object();ToggleEffect.prototype.doEffect=function(){var origHeight="";this.element.origStyleHeight=this.element.style.height;if(typeof this.element.origHeight!="undefined"&&this.element.origHeight!=""){origHeight=this.element.origHeight;if(this.jmsLoggerToggleEffect&&this.jmsLoggerToggleEffect.isDebug){this.jmsLoggerToggleEffect.logDebug("ToggleEffect.doEffect "+this.elementName+" use element.origHeight:"+origHeight);}}else{if(typeof this.element.style.height!="undefined"&&this.element.style.height!=""){origHeight=this.element.style.height;if(this.jmsLoggerToggleEffect&&this.jmsLoggerToggleEffect.isDebug){this.jmsLoggerToggleEffect.logDebug("ToggleEffect.doEffect "+this.elementName+" use element.style.height:"+origHeight);}}else{origHeight=this.element.offsetHeight;if(this.jmsLoggerToggleEffect&&this.jmsLoggerToggleEffect.isDebug){this.jmsLoggerToggleEffect.logDebug("ToggleEffect.doEffect "+this.elementName+" use element.offsetHeight:"+origHeight);}}}this.element.origHeight=origHeight;this.endLength=parseInt(this.element.origHeight);if(!this.element){return null;}if(!(origHeight>0)){if(this.jmsLoggerToggleEffect&&this.jmsLoggerToggleEffect.isDebug){this.jmsLoggerToggleEffect.logDebug("ToggleEffect.doEffect "+this.elementName+" fallback no origHeight:"+origHeight);}if(this.element.style.display=="none"){this.element.style.display="block";}else{this.element.style.display="none";}}else{if(this.jmsLoggerToggleEffect&&this.jmsLoggerToggleEffect.isDebug){this.jmsLoggerToggleEffect.logDebug("ToggleEffect.doEffect "+this.elementName+" do because origHeight set:"+origHeight);}if(this.element.style.display=="none"){this.doEffectShow();}else{this.doEffectHide();}}};ToggleEffect.prototype.doEffectShow=function(){if(this.moving){return;}if(this.element.style.display!="none"){return;}this.moving=true;this.dir="down";this.startEffect();};ToggleEffect.prototype.doEffectHide=function(){if(this.moving){return;}if(this.element.style.display=="none"){return;}this.moving=true;this.dir="up";this.startEffect();};ToggleEffect.prototype.startEffect=function(){if(this.dir=="down"){this.element.style.height="1px";}this.element.style.display="block";this.startTime=(new Date()).getTime();this.timerID=setInterval("var toggler = toggleObjs['"+this.elementName+'\']; if (typeof toggler != "undefined") { toggler.doEffectStep()};',this.timerlen);};ToggleEffect.prototype.doEffectStep=function(){var elapsed=(new Date()).getTime()-this.startTime;if(elapsed>this.slideAniLen){this.endEffect();}else{var d=Math.round(elapsed/this.slideAniLen*this.endLength);if(this.dir=="up"){d=this.endLength-d;}this.element.style.height=d;}return;};ToggleEffect.prototype.endEffect=function(){clearInterval(this.timerID);if(this.dir=="up"){this.element.style.display="none";}this.element.style.height=this.element.origStyleHeight;delete toggleObjs[this.elementName];return;};ToggleEffect.prototype.jmsLoggerToggleEffect=false;}else{if(ToggleEffect.prototype.jmsLoggerToggleEffect&&ToggleEffect.prototype.jmsLoggerToggleEffect.isDebug){ToggleEffect.prototype.jmsLoggerToggleEffect.logDebug("Class ToggleEffect already defined");}}if(typeof(JMATService)=="undefined"){JMATService=function(){JMSBase.call(this);if(this.FLG_CHECK_CLASSES){this.setClassName("JMATService");}};JMATService.prototype=new JMSBase;JMATService.prototype.jmsLoggerJMATService=false;JMATService.prototype.flgUserJMSDiashow=false;JMATService.prototype.initLogger=function(defaultLogLevel,defaultWebLogLevel){var myLogger=false;var webLoggerUrl="weblogger.php?";var myUrl=this.getJMSServiceObj().getMyUrl();var flgLocal=(myUrl.search("http://localhost")===0)&&1;var flgOwnConsole=false;if(myUrl.search("JMATLOGOWNCONSOLE=")>0){flgOwnConsole=true;}if(myUrl.search("JMATLOGGER=DEBUG")>0||(defaultLogLevel&&defaultLogLevel=="DEBUG")){myLogger=new JMSLogger(flgOwnConsole,webLoggerUrl);myLogger.isError=true;myLogger.isWarning=true;myLogger.isInfo=true;myLogger.isDebug=true;}else{if(myUrl.search("JMATLOGGER=INFO")>0||(defaultLogLevel&&defaultLogLevel=="INFO")){myLogger=new JMSLogger(flgOwnConsole,webLoggerUrl);myLogger.isError=true;myLogger.isWarning=true;myLogger.isInfo=true;}else{if(myUrl.search("JMATLOGGER=WARNING")>0||(defaultLogLevel&&defaultLogLevel=="WARNING")){myLogger=new JMSLogger(flgOwnConsole,webLoggerUrl);myLogger.isError=true;myLogger.isWarning=true;}else{if(myUrl.search("JMATLOGGER=ERROR")>0||(defaultLogLevel&&defaultLogLevel=="ERROR")||flgLocal){myLogger=new JMSLogger(flgOwnConsole,webLoggerUrl);myLogger.isError=true;}}}}if(myLogger){if(myUrl.search("JMATWEBLOGGER=DEBUG")>0||(defaultWebLogLevel&&defaultWebLogLevel=="DEBUG")){myLogger.isErrorWebLogger=true;myLogger.isWarningWebLogger=true;myLogger.isInfoWebLogger=true;myLogger.isDebugWebLogger=true;}else{if(myUrl.search("JMATWEBLOGGER=INFO")>0||(defaultWebLogLevel&&defaultWebLogLevel=="INFO")){myLogger.isErrorWebLogger=true;myLogger.isWarningWebLogger=true;myLogger.isInfoWebLogger=true;}else{if(myUrl.search("JMATWEBLOGGER=WARNING")>0||(defaultWebLogLevel&&defaultWebLogLevel=="WARNING")){myLogger.isErrorWebLogger=true;myLogger.isWarningWebLogger=true;}else{if(myUrl.search("JMATWEBLOGGER=ERROR")>0||(defaultWebLogLevel&&defaultWebLogLevel=="ERROR")||flgLocal){myLogger.isErrorWebLogger=true;}}}}}JMATService.prototype.jmsLoggerJMATService=myLogger;JMSClass.prototype.jmsLoggerJMSClass=myLogger;if(typeof(JMSBase)!="undefined"){JMSBase.prototype.jmsLoggerJMSBase=myLogger;}if(typeof(JMSService)!="undefined"){JMSService.prototype.jmsLoggerJMSService=myLogger;}if(typeof(JMSGeoLatLon)!="undefined"){JMSGeoLatLon.prototype.jmsLoggerJMSGeoLatLon=myLogger;}if(typeof(JMSGeoLatLonEleTime)!="undefined"){JMSGeoLatLonEleTime.prototype.jmsLoggerJMSGeoLatLonEleTime=myLogger;}if(typeof(JMSGeoMapFeature)!="undefined"){JMSGeoMapFeature.prototype.jmsLoggerJMSGeoMapFeature=myLogger;}if(typeof(JMSGeoMapFeatureTour)!="undefined"){JMSGeoMapFeatureTour.prototype.jmsLoggerJMSGeoMapFeatureTour=myLogger;}if(typeof(JMSGeoMap)!="undefined"){JMSGeoMap.prototype.jmsLoggerJMSGeoMap=myLogger;}if(typeof(JMSGeoMapDocLoad)!="undefined"){JMSGeoMapDocLoad.prototype.jmsLoggerJMSGeoMapDocLoad=myLogger;}if(typeof(JMSGeoMapJsLoad)!="undefined"){JMSGeoMapJsLoad.prototype.jmsLoggerJMSGeoMapJsLoad=myLogger;}if(typeof(JMSGeoMapFeatureInfoWindowLoad)!="undefined"){JMSGeoMapFeatureInfoWindowLoad.prototype.jmsLoggerJMSGeoMapFeatureInfoWindowLoad=myLogger;}if(typeof(JMSGeoMapGPXLoad)!="undefined"){JMSGeoMapGPXLoad.prototype.jmsLoggerJMSGeoMapGPXLoad=myLogger;}if(typeof(JMSGeoProfile)!="undefined"){JMSGeoProfile.prototype.jmsLoggerJMSGeoProfile=myLogger;}if(typeof(JMSLayout)!="undefined"){JMSLayout.prototype.jmsLoggerJMSLayout=myLogger;}if(typeof(ToggleEffect)!="undefined"){ToggleEffect.prototype.jmsLoggerToggleEffect=myLogger;}if(typeof(JMSGeoTracker)!="undefined"){JMSGeoTracker.prototype.jmsLoggerJMSGeoTracker=myLogger;}if(typeof(JMSGeoTrackViewer)!="undefined"){JMSGeoTrackViewer.prototype.jmsLoggerJMSGeoTrackViewer=myLogger;}return myLogger;};JMATService.prototype.initDefaultServices=function(){this.getJMSServiceObj().registerService("JMSLayout","jsres/jms/JMSLayout.js");this.getJMSServiceObj().loadRegisteredService("JMSLayout");this.getJMSServiceObj().registerService("JMATPageLayout","jsres/jmat/JMATPageLayout.js");this.getJMSServiceObj().loadRegisteredService("JMATPageLayout");if(this.flgUserJMSDiashow){this.getJMSServiceObj().registerService("JMSDiashowService","jsres/jms/JMSDiashowService.js");this.getJMSServiceObj().loadRegisteredService("JMSDiashowService");}};JMATService.prototype.getLayoutService=function(){JMSLayout.prototype.jmsLoggerJMSLayout=this.jmsLoggerJMATService;return this.getServiceObj("JMSLayout");};JMATService.prototype.getPageLayoutService=function(){JMATPageLayout.prototype.jmsLoggerJMATPageLayout=this.jmsLoggerJMATService;return this.getServiceObj("JMATPageLayout");};JMATService.prototype.doJsAfterLoad=function(){this.getPageLayoutService().initPageLayoutStep2AfterLoad();var flgInKatFrame=false;var flgPrintVersion=false;var flgBookVersion=false;if(parent){var parentUrl=parent.location+"";if(parentUrl&&(parentUrl.search("gmap-frame")>0||parentUrl.search("osmmap-frame")>0)){flgInKatFrame=true;}}var myUrl=this.getJMSServiceObj().getMyUrl();if(myUrl.search("ASBOOKVERSION")>0){flgPrintVersion=true;flgBookVersion=true;}if(window.name=="detailframe"){this.getPageLayoutService().showAsDetailFramePage();}if(flgInKatFrame||flgPrintVersion){this.getPageLayoutService().showAsPrintVersion();}if(flgBookVersion){this.getPageLayoutService().showAsBookVersion();}if(this.flgUserJMSDiashow&&flgShowDiashow){var serviceDiashow=this.getServiceObj("JMSDiashowService");if(serviceDiashow){serviceDiashow.createDiashow("dia_gesamt","Alle Bilder der Seite","img4diashow");}}if(1||flgShowTOC){this.getPageLayoutService().showTOC();}};JMATService.prototype.OnUnload=function(){this.getPageLayoutService().showLoadingMsg();};JMATService.prototype.highlightMPFeatureOnMap=function(mapFrameId,type,id){var mapFrame=window.frames[mapFrameId];if(!mapFrame){return false;}mapFrame.contentWindow.highlightMapFeature(type,id);};jMATService=new JMATService();jMATLogger=jMATService.initLogger();jMATService.initDefaultServices();jMATService.getPageLayoutService().activateJSElements();jMATService.getPageLayoutService().activateGeoLocationElements();jMATService.getPageLayoutService().activateSpeechRecognitionElements();jMATService.getPageLayoutService().activateDeviceElements();jMATService.getPageLayoutService().initPageLayoutStep1BeforLoad();}else{if(JMATService.prototype.jmsLoggerJMATService&&JMATService.prototype.jmsLoggerJMATService.isDebug){JMATService.prototype.jmsLoggerJMATService.logDebug("Class JMATService already defined");}}function doJsAfterLoad(){return jMATService.doJsAfterLoad();}function showAsPrintVersion(){return jMATService.getPageLayoutService().showAsPrintVersion();}function showAsBookVersion(){return jMATService.getPageLayoutService().showAsBookVersion();}function startDiashow(name){var serviceDiashow=jMATService.getServiceObj("JMSDiashowService");if(serviceDiashow){serviceDiashow.startDiashow(name);}}function getMaxHeight(){return jMATService.getLayoutService().getMaxHeight();}function moveMapOnBookPage(boxlineDescId,boxDescPrintOptimizedId,boxlineDescPrinOptimizedId,mapId){return jMATService.getLayoutService().moveMapOnPage(boxlineDescId,boxDescPrintOptimizedId,boxlineDescPrinOptimizedId,mapId);}function moveFullBlockOnBookPage(blockId,addOffset){return jMATService.getLayoutService().moveFullBlockOnPage(blockId,addOffset);}function expandPageBreakBlockOnBookPage(blockId,blockPageBreakId,addOffset){return jMATService.getLayoutService().expandPageBreakBlockOnBookPage(blockId,blockPageBreakId,addOffset);}function insertPageBreakBlockOnBookPage(blockId,minOffset,addOffset){return jMATService.getLayoutService().insertPageBreakBlockOnBookPage(blockId,minOffset,addOffset);}function moveBlockOnBookPage(boxlineDescId,boxDescPrintOptimizedId,mapId){return jMATService.getLayoutService().moveBlockOnBookPage(boxlineDescId,boxDescPrintOptimizedId,mapId);}function optimizeTour4print(){return jMATService.getPageLayoutService().optimizeTour4print();}function optimizeKategorie4print(){return jMATService.getPageLayoutService().optimizeKategorie4print();}function optimizeLocation4print(){return jMATService.getPageLayoutService().optimizeLocation4print();}function setKDateBereich(){var input=document.getElementById("K_DATE-BEREICH");if(input){var today=new Date();input.value=String(today.getDate())+"."+String(today.getMonth()+1)+"."+String(today.getFullYear());}}function initNearByForm(strElementIdBlock,gpsFormfeldId){if(!strElementIdBlock){strElementIdBlock="blockSearchFormFieldsNearBy";}divBlock=document.getElementById(strElementIdBlock);if(divBlock){divBlock.style.display="block";}}function initNearBySearch(strElementIdParentDiv,gpsFormfeldId,strElementIdPositionLink,strElementIdBlock,gpsLabelfeldId,gpsBlockId){mapMPDummy=new JMSGeoMapDummy4NearBySearchForm(strElementIdParentDiv,{GPSFORMFIELDID:gpsFormfeldId,GPSLABELFIELDID:gpsLabelfeldId,GPSBLOCKID:gpsBlockId});mapMPDummy.addOsmLocSearch("mapMPDummy");var searchObj=mapMPDummy.getOsmLocSearchObj();searchObj.openOsmSearchWindow();divBlock=document.getElementById(gpsFormfeldId);if(divBlock){document.getElementById("osm_search").style.left=divBlock.style.left;document.getElementById("osm_search").style.top=divBlock.style.top;}sortElement=document.getElementById("SORT");if(sortElement){sortElement.value="GPS_DIST-UP";}}function open_big_picture(url){window.open(url,"_blank","height=650,width=450,resizable=yes,scrollbars=yes");}function open_big_picture600(url){window.open(url,"_blank","height=1050,width=650,resizable=yes,scrollbars=yes");}function openInputFenster(LinkURL,target){if(target==null){target=self;}if(LinkURL!=null){target.focus();MeinFenster=window.open(LinkURL,"Fenster1","width=610,height=350,resizable=yes,dependent=yes,scrollbars=yes");MeinFenster.focus();if(MeinFenster.opener==null){MeinFenster.opener=self;}MeinFenster.opener.targetElement=target;}}function openSpeechRecognitionFenster(LinkURL,target){if(target==null){target=self;}if(LinkURL!=null){target.focus();MeinFenster=window.open(LinkURL,"Fenster2","width=690,height=350,resizable=yes,dependent=yes,scrollbars=yes");MeinFenster.focus();if(MeinFenster.opener==null){MeinFenster.opener=self;}MeinFenster.opener.targetElement=target;}}function showTourAsBookVersion(tId){window.open("./show_tour.php?T_ID="+tId+"&ASBOOKVERSION=1&SHOWALL=1","book","height=800,width=650,resizable=yes,scrollbars=yes");}